---
phase: 01-agent-skills-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Agent-skills package is installed in Claude Code environment"
    - "Kapso MCP server is configured with valid API key"
    - "Claude Code can access 26 Kapso tools via MCP"
    - "Claude can execute at least one Kapso command (list contacts)"
  artifacts:
    - path: "~/.claude/skills/gokapso-agent-skills/"
      provides: "Agent skills for Kapso automation"
      contains: "SKILL.md files for 5 skill sets"
    - path: "~/.claude/settings.local.json (or mcp-servers)"
      provides: "MCP server configuration"
      contains: "kapso server entry with HTTP transport"
  key_links:
    - from: "Claude Code"
      to: "https://app.kapso.ai/mcp"
      via: "MCP HTTP transport with X-API-Key header"
      pattern: "kapso.*https://app.kapso.ai/mcp"
---

<objective>
Install Kapso agent-skills and configure MCP server for enhanced WhatsApp automation development workflow.

Purpose: Agent-skills provide Claude Code with specialized knowledge about Kapso APIs and WhatsApp automation patterns, making subsequent implementation phases (Inbox UI, ARI integration) more efficient. The MCP server enables direct API access to Kapso platform.

Output: Claude Code has Kapso skills loaded and MCP server connected, ready for Phases 2-6.
</objective>

<execution_context>
@/home/jfransisco/.claude/get-shit-done/workflows/execute-plan.md
@/home/jfransisco/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@planning/PROJECT.md
@planning/ROADMAP.md
@planning/phases/01-agent-skills-setup/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install agent-skills and configure MCP server</name>
  <files>None (development tool installation, no application code)</files>
  <action>
    **Step 1: Install Kapso agent-skills**

    Run: `npx skills add gokapso/agent-skills`

    Expected output:
    - Skills added from gokapso/agent-skills
    - 5 skill sets installed: kapso-automation, whatsapp-messaging, whatsapp-flows, kapso-api, kapso-ops

    If installation fails:
    - Ensure Node.js 16+ is available
    - Check network connectivity to npm registry
    - Try `npm cache clean --force` then retry

    **Step 2: Configure Kapso MCP server**

    The API key is stored in `.env.production.local` as confirmed in research.

    Read the API key:
    ```bash
    grep KAPSO .env.production.local
    ```

    Run (replace API_KEY with actual value):
    ```bash
    claude mcp add --transport http \
      --scope user \
      --header "X-API-Key: API_KEY_VALUE" \
      kapso https://app.kapso.ai/mcp
    ```

    Use `--scope user` (per research recommendation - available across all projects, avoids project-scope security concerns given git push is blocked).

    **Step 3: Verify installations**

    Check MCP server is configured:
    ```bash
    claude mcp list
    ```
    Expected: Shows "kapso" server with HTTP transport

    Get server details:
    ```bash
    claude mcp get kapso
    ```
    Expected: Shows URL (https://app.kapso.ai/mcp), headers (X-API-Key: ***), scope (user)
  </action>
  <verify>
    1. `claude mcp list` shows "kapso" in output
    2. `claude mcp get kapso` shows correct URL and transport
    3. No error messages during installation
  </verify>
  <done>
    Agent-skills installed (5 skill sets).
    Kapso MCP server configured with user scope and API key.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Installed Kapso agent-skills and configured MCP server for Claude Code. This enables:
    - Progressive disclosure of Kapso knowledge (skills)
    - Direct API access to Kapso platform (MCP server with 26 tools)
  </what-built>
  <how-to-verify>
    **Within Claude Code conversation, run these commands:**

    1. Check skills loaded:
       Type `/plugin list` or `/skills` - should show gokapso-agent-skills

    2. Check MCP tools available:
       Type `/mcp` - should show 26 Kapso tools including:
       - whatsapp_search_contacts
       - whatsapp_get_inbox
       - whatsapp_send_message
       - etc.

    3. Test a basic command (requires Kapso API to be working):
       Ask: "Can you list my Kapso contacts?"

       Expected: Claude uses whatsapp_search_contacts tool and returns contact data
       (If no contacts exist, should return empty list without error)

    **Troubleshooting if verification fails:**

    - If skills don't appear: Restart Claude Code session
    - If MCP tools don't appear: Check `claude mcp list` from terminal
    - If API calls fail with 401: Verify API key format (no extra whitespace/newlines)
    - If timeout errors: Try `MCP_TIMEOUT=10000` environment variable
  </how-to-verify>
  <resume-signal>Type "verified" if all checks pass, or describe which step failed</resume-signal>
</task>

</tasks>

<verification>
Phase complete when:
- [ ] `npx skills add gokapso/agent-skills` completed without errors
- [ ] `claude mcp add kapso ...` configured successfully
- [ ] `claude mcp list` shows kapso server
- [ ] `/mcp` in Claude Code shows 26 Kapso tools
- [ ] At least one Kapso command executes (even if returns empty data)
</verification>

<success_criteria>
1. Agent-skills package installed with 5 Kapso skill sets
2. Kapso MCP server configured with valid authentication
3. Claude Code can access all 26 Kapso tools
4. A basic command (list contacts) executes without error
</success_criteria>

<output>
After completion, create `planning/phases/01-agent-skills-setup/01-01-SUMMARY.md`
</output>
