# Phase 2.1: UI Documentation

**Type:** INSERTED (documentation before deployment)
**Goal:** Document all UI components, buttons, and their capabilities before production deployment

---

## Why This Phase

Before deploying to production, we need a clear reference of:
1. What each button does
2. How each UI component behaves
3. What the user can expect from the interface

This ensures deployment verification has clear acceptance criteria.

---

## Inbox UI (`/[workspace]/inbox`)

### Layout
- **Two-panel WhatsApp-style design**
- Left: 320px conversation list
- Right: Flexible message thread

### Key Files
```
src/app/(dashboard)/[workspace]/inbox/
├── page.tsx              # Server component, workspace validation
├── inbox-client.tsx      # Client component, filters, selection
├── conversation-list.tsx # Scrollable list with avatars/previews
├── message-thread.tsx    # Message display, auto-scroll
└── compose-input.tsx     # Auto-expanding textarea, send button
```

### Buttons & Controls

| Control | Location | Action |
|---------|----------|--------|
| **Active** pill | Filter bar | Show only conversations with unread messages |
| **All** pill | Filter bar | Show all conversations |
| **Status Filter** | Filter bar | Multi-select dropdown (Baru, Hot, Hangat, Dingin, Terjual, Hilang) |
| **Tags Filter** | Filter bar | Multi-select dropdown, dynamically populated |
| **Search** | Filter bar | Real-time filter by name/phone |
| **Send** button | Compose area | Send message via Kapso API |

### Keyboard Shortcuts
- **Enter** = Send message
- **Shift+Enter** = New line

### Message Features
- WhatsApp-style bubbles (right=outbound, left=inbound)
- Read receipts (✓ sent, ✓✓ delivered, blue ✓✓ read)
- Media: images, documents, video, audio
- Date separators (Indonesian: "Hari Ini", "Kemarin")
- Auto-scroll (smart detection, 100px threshold)

---

## Database/Contacts UI (`/[workspace]/database`)

### Layout
- Full-width data table with toolbar
- Paginated (25 per page)
- Side panel for contact details

### Key Files
```
src/app/(dashboard)/[workspace]/database/
├── page.tsx                  # Server component
├── database-client.tsx       # Main client, filtering, pagination
├── columns.tsx               # Table column definitions
├── merge-contacts-dialog.tsx # Merge modal
└── contact-detail-sheet.tsx  # Side panel for editing
```

### Buttons & Controls

| Control | Location | Action |
|---------|----------|--------|
| **"+ Add Contact"** | Toolbar | Opens add contact form |
| **Status Filter** | Toolbar | Single-select with counts |
| **Tags Filter** | Toolbar | Multi-select (AND logic) |
| **Assigned To** | Toolbar | Filter by team member |
| **Columns** | Toolbar | Toggle visible columns |
| **Merge Duplicates** | Toolbar | Enter merge mode |

---

## MERGE FUNCTIONALITY (Critical)

### Merge Button States

| State | Text | Style |
|-------|------|-------|
| Off | "Merge Duplicates" | Default |
| On | "Cancel Merge" | Secondary/highlighted |

### Merge Flow

```
1. Click "Merge Duplicates"
   └─> Enter merge mode

2. Click first contact
   └─> "1 selected" indicator

3. Click second contact
   └─> "2 selected" indicator
   └─> "Merge Selected (2)" button appears

4. Click "Merge Selected (2)"
   └─> Opens MergeContactsDialog

5. Select values for each field
   └─> Radio buttons: Contact 1 vs Contact 2

6. Click "Merge Contacts"
   └─> POST /api/contacts/merge
   └─> Secondary contact deleted
   └─> Primary contact updated
```

### Merge Dialog Fields

| Field | Selection | Auto-merge |
|-------|-----------|------------|
| Name | Radio (1 or 2) | No |
| Email | Radio (1 or 2) | No |
| Phone | Radio (1 or 2) | No |
| Status | Radio (1 or 2) | No |
| Assigned To | Radio (1 or 2) | No |
| Lead Score | Radio (1 or 2) | No |
| **Tags** | N/A | Yes (union) |
| **Metadata** | N/A | Yes (deep merge) |

---

## Contact Detail Sheet (Side Panel)

Opens when clicking a contact row (not in merge mode).

### Sections

**Header:**
- Avatar (color from phone hash)
- Contact name/phone
- "View conversations" button
- "+ Add note" button

**Editable Fields (inline):**
- Name (click pencil → edit → save/cancel)
- Phone
- Email

**Dropdowns:**
- Lead Status (color-coded)
- Assigned To (team members)

**Slider:**
- Lead Score (0-100, debounced 500ms)

**Checkboxes:**
- Tags (toggle on/off)

**Read-only:**
- Created date
- Conversation status
- Last activity
- Message count
- Form responses (if any)

### Add Note Dialog

| Field | Type |
|-------|------|
| Note text | Textarea (3 rows) |
| Due date | Calendar picker (optional) |

---

## Dashboard Quick Actions

| Button | Goes To |
|--------|---------|
| "+ Add Contact" | `/{workspace}/database?action=add` |
| "Inbox" | `/{workspace}/inbox` |
| "Database" | `/{workspace}/database` |

---

## Lead Status Reference

| Status | Indonesian | Background | Text |
|--------|------------|------------|------|
| all | Semua | gray-100 | gray-800 |
| new | Baru | blue-100 | blue-800 |
| hot | Hot | red-100 | red-800 |
| warm | Hangat | orange-100 | orange-800 |
| cold | Dingin | cyan-100 | cyan-800 |
| sold | Terjual | green-100 | green-800 |
| lost | Hilang | gray-100 | gray-600 |

---

## What's NOT Implemented

- No merge in Inbox (database only)
- No bulk actions (single operations)
- No contact groups/folders
- No advanced sorting in Inbox

---

## localStorage Persistence

These filters persist across sessions:

| Key | Data |
|-----|------|
| `database-status-filter` | Selected status |
| `database-tags-filter` | Selected tags array |
| `database-assigned-filter` | Selected assignee |
| `database-visible-columns` | Column visibility |

---

*Phase: 02.1-ui-documentation*
*Created: 2026-01-25*
