---
phase: 05-polish-deploy
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - scripts/start-ngrok.js
autonomous: true
model: haiku

must_haves:
  truths:
    - "ngrok package is installed as dev dependency"
    - "Script starts ngrok tunnel pointing to localhost:3000"
    - "Script outputs the public URL for webhook configuration"
  artifacts:
    - path: "package.json"
      provides: "ngrok dev dependency"
      contains: "ngrok"
    - path: "scripts/start-ngrok.js"
      provides: "Tunnel startup script"
      min_lines: 20
  key_links:
    - from: "scripts/start-ngrok.js"
      to: "ngrok npm package"
      via: "require/import"
      pattern: "require.*ngrok|from.*ngrok"
---

<objective>
Install ngrok and create a tunnel startup script for localhost webhook testing.

Purpose: Enable Kapso webhooks to reach localhost:3000 during local testing.
Output: ngrok installed, startup script ready to use.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@planning/phases/05-polish-deploy/05-RESEARCH.md (ngrok patterns and code examples)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install ngrok dev dependency</name>
  <files>package.json</files>
  <action>
    Run `npm install --save-dev ngrok` to add ngrok as a dev dependency.

    This is the npm wrapper package for ngrok (not @ngrok/ngrok which is the official SDK).
    The wrapper is simpler for temporary dev testing per RESEARCH.md recommendation.
  </action>
  <verify>
    Run `npm ls ngrok` - should show ngrok in devDependencies.
    Check package.json contains "ngrok" in devDependencies.
  </verify>
  <done>ngrok package appears in package.json devDependencies</done>
</task>

<task type="auto">
  <name>Task 2: Create ngrok tunnel startup script</name>
  <files>scripts/start-ngrok.js</files>
  <action>
    Create a Node.js script that:
    1. Imports ngrok package
    2. Connects to port 3000
    3. Logs the public URL clearly with copy-paste format
    4. Logs instruction: "Update Kapso webhook to: {url}/api/webhook/kapso"
    5. Handles SIGINT to disconnect cleanly
    6. Keeps process running until Ctrl+C

    Use the code pattern from RESEARCH.md Pattern 2.

    Do NOT require NGROK_AUTHTOKEN - free tier works without it for basic tunnels.
  </action>
  <verify>
    Run `node scripts/start-ngrok.js` - should:
    1. Print a URL like https://abc123.ngrok-free.dev
    2. Print webhook URL instruction
    3. Stay running until Ctrl+C
    4. Exit cleanly on Ctrl+C
  </verify>
  <done>Script runs and outputs ngrok public URL</done>
</task>

</tasks>

<verification>
1. `npm ls ngrok` shows package installed
2. `node scripts/start-ngrok.js` outputs public URL
3. Ctrl+C exits cleanly
</verification>

<success_criteria>
- ngrok in package.json devDependencies
- scripts/start-ngrok.js exists and runs
- Script outputs usable public URL for webhook testing
</success_criteria>

<output>
After completion, create `.planning/phases/05-polish-deploy/05-01-SUMMARY.md`
</output>
