---
phase: 19-performance-security
plan: 05
type: execute
wave: 2
depends_on: [19-03]
files_modified:
  - src/lib/mock-data.ts
  - src/app/api/articles/[id]/route.ts
  - package.json
autonomous: true

must_haves:
  truths:
    - "npm run build completes without TypeScript errors"
    - "Public article endpoints return Cache-Control headers"
    - "All dependencies are at latest patch versions"
  artifacts:
    - path: "src/lib/mock-data.ts"
      provides: "Fixed TypeScript types"
    - path: "src/app/api/articles/[id]/route.ts"
      provides: "Cacheable article responses"
      contains: "Cache-Control"
  key_links:
    - from: "src/app/api/articles/[id]/route.ts"
      to: "NextResponse headers"
      via: "Cache-Control header"
      pattern: "Cache-Control"
---

<objective>
Fix build errors and add basic performance optimizations

Purpose: Ensure production build works and public content is cached
Output: Clean build, caching headers on public content, updated dependencies
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/19-performance-security/19-RESEARCH.md

@src/lib/mock-data.ts
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix TypeScript build error in mock-data.ts</name>
  <files>src/lib/mock-data.ts</files>
  <action>
    The research identified a missing `is_admin` property causing build failure.

    1. First, run `npm run build` to identify the exact error
    2. Read src/lib/mock-data.ts and find the workspace_members mock data
    3. Add the missing `is_admin: boolean` property to any workspace member objects

    Expected fix pattern:
    ```typescript
    // Find objects like:
    {
      id: '...',
      workspace_id: '...',
      user_id: '...',
      role: 'owner',
      // Add this if missing:
      is_admin: true,
    }
    ```

    The `is_admin` should be:
    - `true` for role 'owner' or 'admin'
    - `false` for role 'member'
  </action>
  <verify>
    npm run build (should complete without type errors)
  </verify>
  <done>TypeScript build completes successfully</done>
</task>

<task type="auto">
  <name>Task 2: Add caching headers to public content endpoints</name>
  <files>src/app/api/articles/[id]/route.ts</files>
  <action>
    Add Cache-Control headers to public article endpoints. Articles are semi-static content that can be cached.

    Update the GET response to include caching headers:

    ```typescript
    return NextResponse.json(
      { article },
      {
        headers: {
          'Cache-Control': 'public, s-maxage=3600, stale-while-revalidate=86400',
        },
      }
    )
    ```

    This means:
    - `public`: CDN can cache
    - `s-maxage=3600`: Cache for 1 hour on CDN
    - `stale-while-revalidate=86400`: Serve stale for 24h while revalidating

    Also check if there's a public articles list endpoint and apply the same pattern.

    Note: Do NOT add caching to:
    - Any authenticated endpoints
    - Webhook endpoints
    - Message or contact endpoints
  </action>
  <verify>
    grep "Cache-Control" src/app/api/articles/[id]/route.ts
  </verify>
  <done>Public content endpoints return appropriate cache headers</done>
</task>

<task type="auto">
  <name>Task 3: Update outdated dependencies</name>
  <files>package.json</files>
  <action>
    Run npm update to get latest patch versions of all dependencies:

    ```bash
    npm update
    ```

    The research identified these outdated:
    - @types/node: 20.19.29 -> latest 20.x
    - next: 16.1.1 -> 16.1.3
    - eslint-config-next: 16.1.1 -> 16.1.3

    After update:
    1. Run `npm run build` to verify nothing broke
    2. Run `npm audit` to confirm no vulnerabilities

    Note: Do NOT upgrade to next major versions (like @types/node 25.x) as that could introduce breaking changes.
  </action>
  <verify>
    npm run build (passes)
    npm audit (no vulnerabilities)
    npm outdated (shows fewer or no outdated packages)
  </verify>
  <done>Dependencies updated to latest patch versions</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `npm audit` shows 0 vulnerabilities
3. Cache headers present on public endpoints:
   - grep "Cache-Control" src/app/api/articles/[id]/route.ts
4. No critical outdated packages:
   - npm outdated (major version updates are OK to defer)
</verification>

<success_criteria>
- TypeScript build passes with no errors
- Public article endpoint cached for 1 hour on CDN
- All dependencies at latest patch versions
- npm audit shows 0 vulnerabilities
</success_criteria>

<output>
After completion, create `.planning/phases/19-performance-security/19-05-SUMMARY.md`
</output>
