---
phase: 03-inbox-core
plan: 03
type: execute
---

<objective>
Add lead status filtering and polish the inbox UI.

Purpose: Allow users to filter conversations by lead status (Hot, Warm, Cold, etc.) matching the Database view pattern.
Output: Inbox with status filter popover and polished empty states.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-inbox-core/03-RESEARCH.md
@.planning/phases/03-inbox-core/03-02-SUMMARY.md

# Key files to reference:
@src/app/(dashboard)/[workspace]/database/database-client.tsx
@src/lib/lead-status.ts
@src/app/(dashboard)/[workspace]/inbox/inbox-client.tsx
@src/app/(dashboard)/[workspace]/inbox/conversation-list.tsx

**From database-client.tsx:** Status filter pattern with Popover, Checkbox, Badge count
**Established patterns:** Status filtering like Database view
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add status filter to inbox header</name>
  <files>src/app/(dashboard)/[workspace]/inbox/inbox-client.tsx</files>
  <action>
Add lead status filtering above conversation list, matching database-client.tsx pattern.

Add state:
- statusFilter: string[] (empty = all statuses)

Add above conversation list:
- Filter button with Popover
- Checkboxes for each lead status from LEAD_STATUSES
- Badge showing count if filters active
- Clear button when filters applied

Filter conversations:
- If statusFilter empty, show all
- Otherwise, filter where contact.lead_status is in statusFilter array

Reuse the Popover pattern from database-client.tsx.
  </action>
  <verify>Filter popover appears, selecting statuses filters conversation list</verify>
  <done>Status filter works identically to Database view pattern</done>
</task>

<task type="auto">
  <name>Task 2: Add empty states and polish</name>
  <files>
src/app/(dashboard)/[workspace]/inbox/inbox-client.tsx,
src/app/(dashboard)/[workspace]/inbox/conversation-list.tsx,
src/app/(dashboard)/[workspace]/inbox/message-thread.tsx
  </files>
  <action>
Add proper empty states and polish the UI.

ConversationList empty states:
- No conversations: "No conversations yet. Messages will appear when leads contact you."
- No search results: "No conversations match your search"
- No filter results: "No conversations match selected filters"

MessageThread states:
- No conversation selected: Centered message "Select a conversation to view messages"
- Loading messages: Show loading skeleton or spinner
- No messages in conversation: "No messages yet in this conversation"

Polish:
- Ensure consistent spacing and colors
- Header aligned with Database page header style
- Make sure clicking outside filter popover closes it
  </action>
  <verify>All empty states display correctly in various scenarios</verify>
  <done>Empty states inform users clearly, UI feels polished and consistent</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete inbox with conversation list, message display, and status filtering</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/demo/inbox
    3. Test conversation list:
       - Conversations appear with avatars, names, preview, time
       - Lead status dots show correct colors
       - Search filters by name/phone
    4. Test message display:
       - Click conversation, messages load
       - Inbound messages left/gray, outbound right/orange
       - Scrolls to latest message
       - Header shows contact info and status badge
    5. Test status filter:
       - Click filter button, popover appears
       - Select status(es), list filters correctly
       - Badge shows filter count
       - Clear resets filters
    6. Test empty states:
       - Search for nonexistent term
       - Filter to status with no conversations
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Status filter works like Database view
- [ ] Empty states display correctly
- [ ] All previous functionality still works
- [ ] UI is polished and consistent
</verification>

<success_criteria>

- Lead status filtering complete
- Empty states informative
- Inbox visually polished
- Phase 3 complete - ready for Phase 4 (Inbox Send)
</success_criteria>

<output>
After completion, create `.planning/phases/03-inbox-core/03-03-SUMMARY.md`

Update `.planning/STATE.md`:
- Phase: 3 of 5 (Inbox Core) → Complete
- Progress: 70%
- Add decisions made

Update `.planning/ROADMAP.md`:
- Phase 3 row: status → Complete, date → today
</output>
