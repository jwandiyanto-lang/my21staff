---
phase: 2.1-production-bug-remediation
plan: 06
type: execute
wave: 3
depends_on: []
files_modified:
  - src/components/dashboard/activities-widget.tsx
  - src/components/settings/team-management-tab.tsx
  - src/components/settings/whatsapp-integration-tab.tsx
  - src/app/(dashboard)/[workspace]/settings/page.tsx
  - src/lib/i18n/translations.ts
autonomous: true

must_haves:
  truths:
    - "All UI text is in English (no Indonesian words)"
    - "WhatsApp integration shows only Meta phone number option (API option hidden)"
    - "Settings forms save and apply changes correctly"
    - "Clerk deprecation warning resolved"
  artifacts:
    - path: "src/lib/i18n/translations.ts"
      provides: "English translations for all UI strings"
      min_lines: 50
    - path: "src/components/settings/whatsapp-integration-tab.tsx"
      provides: "WhatsApp integration UI with Meta option only"
      min_lines: 60
    - path: "src/app/(dashboard)/[workspace]/settings/page.tsx"
      provides: "Settings page with working form submissions"
      min_lines: 80
  key_links:
    - from: "src/components/dashboard/activities-widget.tsx"
      to: "src/lib/i18n/translations.ts"
      via: "translation keys"
      pattern: "t\\('activities"
    - from: "src/components/settings/whatsapp-integration-tab.tsx"
      to: "Meta integration only"
      via: "no API option visible"
      pattern: "!.*api.*option"
---

<objective>
Fix internationalization issues, WhatsApp integration UI, Settings form functionality, and Clerk deprecation warning.

Purpose: Address 8 medium priority issues affecting UX and completeness: Indonesian words in Dashboard/Settings (Issues #14, #15), WhatsApp API option visible when it should be hidden (Issue #16), Settings forms not saving (Issues #18, #20), Clerk deprecation warning (Issue #21). These don't block core workflows but degrade user experience and need cleanup.

Output: Polished UI with English-only text, proper WhatsApp integration UI, working Settings forms, and no deprecation warnings.
</objective>

<execution_context>
@/home/jfransisco/.claude/get-shit-done/workflows/execute-plan.md
@/home/jfransisco/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/home/jfransisco/Desktop/21/my21staff/.planning/PROJECT.md
@/home/jfransisco/Desktop/21/my21staff/.planning/ROADMAP.md
@/home/jfransisco/Desktop/21/my21staff/.planning/STATE.md
@/home/jfransisco/Desktop/21/my21staff/.planning/phases/02-production-deployment/02-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Fix internationalization - replace Indonesian with English</name>
  <files>
    src/components/dashboard/activities-widget.tsx
    src/components/settings/team-management-tab.tsx
    src/lib/i18n/translations.ts
  </files>
  <action>
**Fix Indonesian words in UI:**

Issues #14 and #15 report Indonesian words in Dashboard and Settings that need English translation.

**Implementation steps:**

1. **Find Indonesian text**:
```bash
# Search for common Indonesian words
grep -r "Kegiatan\|Terbaru\|Tambah\|Hapus\|Simpan" src/components/
grep -r "Anggota\|Tim\|Pengaturan" src/components/settings/
```

2. **Dashboard - "Kegiatan Terbaru"** (Issue #14):
   - Find: `src/components/dashboard/activities-widget.tsx`
   - Replace: "Kegiatan Terbaru" → "Recent Activities"
   - Pattern: Look for widget title or heading

```typescript
// Before
<h2>Kegiatan Terbaru</h2>

// After
<h2>Recent Activities</h2>
```

3. **Settings - Team Management Indonesian words** (Issue #15):
   - Find: `src/components/settings/team-management-tab.tsx`
   - Common Indonesian terms to replace:
     - "Anggota Tim" → "Team Members"
     - "Tambah Anggota" → "Add Member"
     - "Hapus" → "Delete"
     - "Simpan" → "Save"
     - "Peran" → "Role"

4. **Create or update translations file**:
```typescript
// src/lib/i18n/translations.ts
export const translations = {
  en: {
    dashboard: {
      activities: "Recent Activities",
      tasks: "Tasks",
      // ...
    },
    settings: {
      teamManagement: "Team Management",
      addMember: "Add Member",
      deleteMember: "Delete Member",
      save: "Save",
      role: "Role",
      // ...
    },
  },
  // id: { ... } for future Indonesian support
};
```

5. **Audit for any remaining Indonesian text**:
```bash
# Check for common Indonesian words across codebase
grep -r "Kegiatan\|Terbaru\|Anggota\|Simpan\|Hapus" src/ --include="*.tsx" --include="*.ts"
```

6. **Replace all instances with English**:
   - Dashboard widgets
   - Settings tabs
   - Button labels
   - Form labels
   - Error messages

**Testing approach:**
1. Visit Dashboard - verify "Recent Activities" (not "Kegiatan Terbaru")
2. Visit Settings > Team Management - verify all English labels
3. Check all Settings tabs for any Indonesian text
  </action>
  <verify>
```bash
# Audit for Indonesian words
echo "Checking for Indonesian text in UI:"
grep -r "Kegiatan\|Terbaru\|Anggota\|Simpan\|Hapus\|Tambah" src/components/ --include="*.tsx" || echo "No Indonesian text found ✓"

# Manual verification
echo ""
echo "Manual checks:"
echo "1. Visit Dashboard - activities widget should say 'Recent Activities'"
echo "2. Visit Settings > Team Management - all labels in English"
echo "3. Check all buttons and forms - no Indonesian words"
```
  </verify>
  <done>
- All Dashboard UI text is in English (no "Kegiatan Terbaru")
- All Settings UI text is in English (no "Anggota Tim", "Tambah", etc.)
- translations.ts file created with English strings
- No Indonesian words remain in production UI
- Issues #14 and #15 from verification report resolved
  </done>
</task>

<task type="auto">
  <name>Fix WhatsApp integration UI and Settings form issues</name>
  <files>
    src/components/settings/whatsapp-integration-tab.tsx
    src/components/settings/status-filters-tab.tsx
    src/app/(dashboard)/[workspace]/settings/page.tsx
    src/app/providers.tsx
  </files>
  <action>
**Fix multiple Settings issues:**

**Issue #16: WhatsApp shows API option (should only show Meta phone)**
- API integration is internal-only (Kapso)
- Users should only see Meta phone number integration option
- Hide or remove API integration UI

**Issue #18: Status filter no save button**
- Status filter settings can't be persisted
- Add save button or auto-save functionality

**Issue #20: Leads missing form data**
- Lead form configuration incomplete
- Add missing form fields

**Issue #21: Clerk deprecation warning**
- `afterSignInUrl` deprecated, should use `fallbackRedirectUrl`
- Fix in Clerk provider configuration

**Implementation steps:**

1. **Fix WhatsApp integration UI** (Issue #16):
```typescript
// src/components/settings/whatsapp-integration-tab.tsx
export function WhatsAppIntegrationTab() {
  return (
    <div>
      <h2>WhatsApp Integration</h2>

      {/* Only show Meta phone number option */}
      <div className="integration-option">
        <h3>Meta Phone Number</h3>
        <p>Connect via Meta Business API</p>
        <button>Configure Meta Integration</button>
      </div>

      {/* REMOVE or HIDE API option - internal only */}
      {/*
      <div className="integration-option">
        <h3>API Integration</h3>  // REMOVE THIS
        <p>Direct API connection</p>
      </div>
      */}
    </div>
  );
}
```

2. **Add save button to Status filters** (Issue #18):
```typescript
// src/components/settings/status-filters-tab.tsx
export function StatusFiltersTab() {
  const [filters, setFilters] = useState([]);
  const [hasChanges, setHasChanges] = useState(false);

  async function handleSave() {
    // Save filters to database
    await fetch('/api/workspaces/[id]/settings', {
      method: 'PUT',
      body: JSON.stringify({ status_filters: filters }),
    });
    setHasChanges(false);
  }

  return (
    <div>
      <h2>Status Filters</h2>
      {/* Filter configuration UI */}

      {/* Add save button */}
      <button
        onClick={handleSave}
        disabled={!hasChanges}
      >
        Save Filters
      </button>
    </div>
  );
}
```

3. **Fix Leads form data** (Issue #20):
```typescript
// src/components/settings/leads-tab.tsx or similar
export function LeadsTab() {
  return (
    <div>
      <h2>Lead Configuration</h2>

      {/* Add missing form fields */}
      <FormField name="lead_source" label="Lead Source" />
      <FormField name="lead_status_default" label="Default Status" />
      <FormField name="lead_assignment_rules" label="Assignment Rules" />
      {/* Add any other missing fields based on requirements */}

      <button>Save Lead Settings</button>
    </div>
  );
}
```

4. **Fix Clerk deprecation warning** (Issue #21):
```typescript
// src/app/providers.tsx
import { ClerkProvider } from '@clerk/nextjs';

export function Providers({ children }) {
  return (
    <ClerkProvider
      // BEFORE (deprecated):
      // afterSignInUrl="/dashboard"

      // AFTER (correct):
      fallbackRedirectUrl="/dashboard"
    >
      {children}
    </ClerkProvider>
  );
}
```

5. **Test all Settings changes**:
   - WhatsApp tab shows only Meta option (no API)
   - Status filters can be saved
   - Leads form has complete fields
   - No Clerk deprecation warning in console

**Testing approach:**
1. Visit Settings > WhatsApp Integration - only Meta option visible
2. Visit Settings > Status Filters - can save changes
3. Visit Settings > Leads - form has all fields
4. Check browser console - no Clerk warnings
  </action>
  <verify>
```bash
# Check Clerk provider config
grep -A 5 "ClerkProvider" src/app/providers.tsx | grep "fallbackRedirectUrl"

# Manual verification
echo ""
echo "Manual Settings checks:"
echo "1. Settings > WhatsApp: Only Meta phone number option visible (no API option)"
echo "2. Settings > Status Filters: Save button present and works"
echo "3. Settings > Leads: Form has complete field set"
echo "4. Browser console: No Clerk deprecation warnings"
```
  </verify>
  <done>
- WhatsApp integration shows only Meta phone number option (API option hidden)
- Status filter tab has save button and persists changes
- Leads form has complete field set (no missing data)
- Clerk provider uses fallbackRedirectUrl (not deprecated afterSignInUrl)
- No deprecation warnings in browser console
- Issues #16, #18, #20, #21 from verification report resolved
  </done>
</task>

</tasks>

<verification>
**Internationalization verification:**
- Dashboard shows "Recent Activities" (not "Kegiatan Terbaru")
- Settings shows English labels (not "Anggota Tim", "Tambah")
- No Indonesian text in any UI component

**Settings verification:**
- WhatsApp tab: Meta option only (no API option)
- Status filters: Save button works
- Leads form: Complete fields present
- Console: No Clerk deprecation warnings

**Success indicators:**
- All UI text in English
- Settings forms functional
- No console warnings
- Issues #14, #15, #16, #18, #20, #21 resolved
</verification>

<success_criteria>
1. All Dashboard and Settings UI text is in English (no Indonesian)
2. WhatsApp integration shows only Meta phone number option (API hidden)
3. Status filter settings can be saved and persisted
4. Leads form has complete field set
5. Clerk uses fallbackRedirectUrl (no deprecation warnings)
6. Browser console shows no Clerk-related warnings
7. Verification confirms Issues #14, #15, #16, #18, #20, #21 are resolved
</success_criteria>

<output>
After completion, create `.planning/phases/2.1-production-bug-remediation/2.1-06-SUMMARY.md`
</output>
