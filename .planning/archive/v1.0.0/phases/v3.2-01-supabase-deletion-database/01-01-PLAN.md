---
phase: v3.2-01
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/workspace/sidebar.tsx
  - src/app/(dashboard)/[workspace]/page.tsx
  - src/app/(dashboard)/[workspace]/inbox/page.tsx
  - src/app/(dashboard)/[workspace]/inbox/inbox-client.tsx
  - src/app/(dashboard)/[workspace]/inbox/message-thread.tsx
  - src/app/(dashboard)/[workspace]/settings/page.tsx
  - src/app/(dashboard)/[workspace]/support/page.tsx
  - src/app/(dashboard)/[workspace]/support/[id]/page.tsx
  - src/app/(dashboard)/[workspace]/knowledge-base/page.tsx
  - src/app/(dashboard)/[workspace]/integrations/page.tsx
  - src/app/(dashboard)/[workspace]/website/page.tsx
  - src/app/(dashboard)/dashboard/page.tsx
  - src/app/(dashboard)/admin/clients/page.tsx
  - src/app/(dashboard)/admin/layout.tsx
  - src/app/portal/layout.tsx
  - src/app/portal/support/page.tsx
  - src/app/portal/support/[id]/page.tsx
  - src/app/webinars/[workspace]/[slug]/page.tsx
  - src/app/articles/[workspace]/[slug]/page.tsx
  - src/components/inbox/appointment-card.tsx
  - src/components/auth/login-modal.tsx
  - src/lib/supabase/client.ts
  - src/lib/supabase/server.ts
  - src/lib/supabase/config.ts
  - package.json
autonomous: true

must_haves:
  truths:
    - "Navigation sidebar shows only working pages (Lead Management, Team)"
    - "No TypeScript errors from Supabase imports"
    - "App builds successfully without @supabase packages"
  artifacts:
    - path: "src/components/workspace/sidebar.tsx"
      provides: "Navigation with only working links"
      contains: "database"
    - path: "package.json"
      provides: "No @supabase dependencies"
  key_links:
    - from: "src/components/workspace/sidebar.tsx"
      to: "/database"
      via: "operationsNav array"
      pattern: "href.*database"
---

<objective>
Delete all Supabase page files and remove @supabase packages from the codebase.

Purpose: Clean slate for v3.2 - remove dead code that blocks build after Supabase lib deletion
Output: Codebase with no Supabase dependencies, navigation showing only working pages
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/v3.2-01-supabase-deletion-database/01-CONTEXT.md
@.planning/phases/v3.2-01-supabase-deletion-database/01-RESEARCH.md
@.planning/phases/07-cleanup-verification/07-07-SUMMARY.md
@src/components/workspace/sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update sidebar navigation to show only working pages</name>
  <files>src/components/workspace/sidebar.tsx</files>
  <action>
Update the operationsNav and adminNav arrays to only include pages that work with Convex:

**Keep in operationsNav:**
- Lead Management (href: '/database') - already works with Convex

**Remove from operationsNav:**
- Dashboard (href: '') - Supabase-dependent
- Conversations (href: '/inbox') - Supabase-dependent
- Support (href: '/support') - Supabase-dependent

**Keep in adminNav:**
- Settings (href: '/settings') - keep for now, will redirect to team

**Remove from adminNav:**
- Your Intern (href: '/knowledge-base') - Supabase-dependent

Also remove the unread count badge logic (lines 72-95 that use createClient) - just set unreadCount to 0 for now. Remove the `import { createClient } from '@/lib/supabase/client'` line.

The sidebar should still render properly with the reduced navigation.
  </action>
  <verify>
1. Check sidebar.tsx has no `@/lib/supabase` import
2. Check operationsNav only contains database entry
3. Run `npx tsc --noEmit` - no TypeScript errors
  </verify>
  <done>
Sidebar shows only Lead Management link. No Supabase imports in sidebar.tsx.
  </done>
</task>

<task type="auto">
  <name>Task 2: Delete all Supabase-dependent files</name>
  <files>
src/app/(dashboard)/[workspace]/page.tsx
src/app/(dashboard)/[workspace]/inbox/page.tsx
src/app/(dashboard)/[workspace]/inbox/inbox-client.tsx
src/app/(dashboard)/[workspace]/inbox/message-thread.tsx
src/app/(dashboard)/[workspace]/settings/page.tsx
src/app/(dashboard)/[workspace]/support/page.tsx
src/app/(dashboard)/[workspace]/support/[id]/page.tsx
src/app/(dashboard)/[workspace]/knowledge-base/page.tsx
src/app/(dashboard)/[workspace]/integrations/page.tsx
src/app/(dashboard)/[workspace]/website/page.tsx
src/app/(dashboard)/dashboard/page.tsx
src/app/(dashboard)/admin/clients/page.tsx
src/app/(dashboard)/admin/layout.tsx
src/app/portal/layout.tsx
src/app/portal/support/page.tsx
src/app/portal/support/[id]/page.tsx
src/app/webinars/[workspace]/[slug]/page.tsx
src/app/articles/[workspace]/[slug]/page.tsx
src/components/inbox/appointment-card.tsx
src/components/auth/login-modal.tsx
src/lib/supabase/client.ts
src/lib/supabase/server.ts
src/lib/supabase/config.ts
  </files>
  <action>
Delete ALL the files listed above using rm commands:

```bash
# Delete Supabase lib files
rm -rf src/lib/supabase/

# Delete inbox folder (3 files inside)
rm -rf src/app/\(dashboard\)/\[workspace\]/inbox/

# Delete support folder
rm -rf src/app/\(dashboard\)/\[workspace\]/support/

# Delete individual page files
rm src/app/\(dashboard\)/\[workspace\]/page.tsx
rm src/app/\(dashboard\)/\[workspace\]/settings/page.tsx
rm src/app/\(dashboard\)/\[workspace\]/knowledge-base/page.tsx
rm src/app/\(dashboard\)/\[workspace\]/integrations/page.tsx
rm src/app/\(dashboard\)/\[workspace\]/website/page.tsx

# Delete dashboard folder
rm -rf src/app/\(dashboard\)/dashboard/

# Delete admin folder
rm -rf src/app/\(dashboard\)/admin/

# Delete portal folder
rm -rf src/app/portal/

# Delete public content folders
rm -rf src/app/webinars/
rm -rf src/app/articles/

# Delete orphaned components
rm src/components/inbox/appointment-card.tsx
rm src/components/auth/login-modal.tsx
```

**DO NOT DELETE:**
- src/app/(dashboard)/[workspace]/database/ - working with Convex
- src/app/(dashboard)/[workspace]/team/ - working with Clerk
- src/app/(dashboard)/[workspace]/layout.tsx - will be migrated in next plan
  </action>
  <verify>
1. Run `ls src/lib/supabase/` - should error (directory not found)
2. Run `grep -r "@/lib/supabase" src/` - should return no matches
3. Run `ls src/app/\(dashboard\)/\[workspace\]/` - should only show database, team, layout.tsx
  </verify>
  <done>
All 23 Supabase-dependent files deleted. Only database/, team/, and layout.tsx remain in workspace folder.
  </done>
</task>

<task type="auto">
  <name>Task 3: Remove @supabase packages and verify build</name>
  <files>package.json</files>
  <action>
1. Remove Supabase packages:
```bash
npm uninstall @supabase/ssr @supabase/supabase-js
```

2. Clean npm cache and reinstall:
```bash
rm -rf node_modules/.cache
npm install
```

3. Run build to verify:
```bash
npm run build
```

**Expected:** Build should fail because layout.tsx still imports Supabase. That's OK - we'll fix it in the next plan. Document the specific error in the summary.

**If build has OTHER errors:** Fix them before proceeding. The only acceptable error is the layout.tsx Supabase import.
  </action>
  <verify>
1. Check package.json has no @supabase entries: `grep -c "supabase" package.json` should return 0
2. Run `npm run build` - document result (expect layout.tsx error only)
  </verify>
  <done>
@supabase packages removed from package.json. Build attempted - layout.tsx migration deferred to Plan 02.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `grep -r "@/lib/supabase" src/` returns no matches
2. `grep -c "supabase" package.json` returns 0
3. Navigation sidebar code has no Supabase imports
4. Only database/, team/, layout.tsx in workspace folder
</verification>

<success_criteria>
- All 23 Supabase-dependent page/component files deleted
- Supabase lib folder deleted
- @supabase packages removed from package.json
- Sidebar navigation updated to show only working pages
- Build error is ONLY from layout.tsx (to be fixed in Plan 02)
</success_criteria>

<output>
After completion, create `.planning/phases/v3.2-01-supabase-deletion-database/01-01-SUMMARY.md`
</output>
