---
phase: 07-cleanup-verification
plan: 08
type: execute
wave: 4
depends_on: ["07-07"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can sign in with Clerk"
    - "User can view contacts in Eagle CRM"
    - "User can send WhatsApp messages"
    - "New leads appear from n8n flow"
    - "ARI responds to WhatsApp messages"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete Convex + Clerk stack works end-to-end with Eagle's production data.

Purpose: Final verification that the migration is complete and everything works.
Output: Confirmed working system, ready for production
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Convex + Clerk migration with Supabase removed</what-built>
  <how-to-verify>
**1. Authentication Flow:**
- [ ] Sign out if signed in
- [ ] Visit https://my21staff.vercel.app/sign-in
- [ ] Sign in with your Clerk credentials
- [ ] Confirm you reach the dashboard

**2. Eagle CRM - Contacts:**
- [ ] Navigate to /eagle-overseas/database
- [ ] Confirm contacts list loads (should see Eagle's contacts)
- [ ] Click on a contact to view details
- [ ] Confirm contact detail sheet opens with data

**3. Eagle CRM - Inbox:**
- [ ] Navigate to /eagle-overseas/inbox
- [ ] Confirm conversations list loads
- [ ] Select a conversation
- [ ] Confirm message history loads
- [ ] Type a test message and send (or skip if don't want to message real contacts)

**4. n8n Lead Flow:**
- [ ] Go to n8n (http://100.113.96.25:5678)
- [ ] Find the Google Sheets -> Convex workflow
- [ ] Trigger a test (or wait for real form submission)
- [ ] Check if new lead appears in Eagle CRM

**5. ARI (if enabled for Eagle):**
- [ ] Send a WhatsApp message to Eagle's number
- [ ] Confirm ARI responds (check inbox for response)
- [ ] OR: Confirm message appears in inbox if ARI not enabled

**6. Team Management:**
- [ ] Navigate to /eagle-overseas/team
- [ ] Confirm team members list loads
- [ ] Confirm invite button opens Clerk modal

**Quick sanity checks:**
- [ ] No JavaScript errors in browser console
- [ ] No "supabase" references in network tab
- [ ] Performance feels normal (no significant slowdown)
  </how-to-verify>
  <resume-signal>
Type "verified" if all checks pass.
Type "issue: [description]" if something is broken.
  </resume-signal>
</task>

<task type="auto">
  <name>Task 2: Create final migration summary</name>
  <files>.planning/STATE.md</files>
  <action>
Update STATE.md to reflect migration completion:

1. Update "Current Position" to Phase 7 complete
2. Add to "Accumulated Context":
   - v3.1 Migration Status: COMPLETE
   - Supabase fully removed
   - All data on Convex
   - All auth on Clerk

3. Add verification results from Task 1

4. Update progress counter

Example update:
```markdown
## Current Position

Phase: 7 of 7 (Cleanup + Verification)
Plan: 07-08 complete - 8 of 8 plans done
Status: v3.1 COMPLETE
Last activity: 2026-01-XX - Phase 7 complete, Supabase removed

Progress: v1.0 ██████████ | v2.0 ██████████ | v2.1 ██████████ | v2.2 ██████████ | v3.0 ██████████ | v3.1 ██████████ (172 plans shipped)
```
  </action>
  <verify>
STATE.md updated with completion status
  </verify>
  <done>
STATE.md reflects v3.1 migration complete
  </done>
</task>

</tasks>

<verification>
All verification is in Task 1's human-verify checkpoint.
</verification>

<success_criteria>
1. Auth flow works (sign in, sign out)
2. Contacts load in Eagle CRM
3. Inbox loads with message history
4. n8n leads appear in CRM
5. ARI responds (if enabled)
6. Team management works
7. No Supabase references in network traffic
8. STATE.md updated to reflect completion
</success_criteria>

<output>
After completion, create `.planning/phases/07-cleanup-verification/07-08-SUMMARY.md`

This is the final plan for v3.1. Upon completion:
- v3.1 Full Convex + Clerk is COMPLETE
- Supabase is removed from the stack
- Ready for production use
</output>
