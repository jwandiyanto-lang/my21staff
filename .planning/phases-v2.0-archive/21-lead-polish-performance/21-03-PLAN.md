---
wave: 2
depends_on: [21-01]
files_modified: [src/app/(dashboard)/[workspace]/database/contact-detail-sheet.tsx, src/app/(dashboard)/[workspace]/inbox/message-thread.tsx]
autonomous: true
---

# 21-03: Notes Dates Display with WIB

## Objective

Update notes and activity displays to use WIB timezone formatting consistently.

## Tasks

<task id="1">
Update `src/app/(dashboard)/[workspace]/database/contact-detail-sheet.tsx`:

Import the new timezone utilities at the top:
```typescript
import { formatWIB, formatDistanceWIB, DATE_FORMATS } from '@/lib/utils'
```

Find all date formatting in the activity timeline (around lines 424-568) and notes display:

Replace occurrences of:
- `format(new Date(date), 'MMM d, HH:mm')` → `formatWIB(date, DATE_FORMATS.DATETIME)`
- `formatDistanceToNow(new Date(date), { addSuffix: true })` → `formatDistanceWIB(date, { addSuffix: true })`
- `format(new Date(note.created_at), 'MMM d, HH:mm')` → `formatWIB(note.created_at, DATE_FORMATS.DATETIME)`

For due dates display, use consistent format:
- `format(new Date(note.due_date), ...)` → `formatWIB(note.due_date, DATE_FORMATS.DATETIME_LONG)`
</task>

<task id="2">
Update activity item rendering to show clearer timestamps:

For activity items, display both relative and absolute time:
```typescript
<div className="text-xs text-muted-foreground">
  {formatDistanceWIB(item.created_at, { addSuffix: true })}
  <span className="mx-1">·</span>
  {formatWIB(item.created_at, DATE_FORMATS.DATETIME)}
</div>
```

This shows: "2 hours ago · Jan 17, 14:30"
</task>

<task id="3">
Update `src/app/(dashboard)/[workspace]/inbox/message-thread.tsx`:

Import timezone utilities:
```typescript
import { formatWIB, formatDistanceWIB, DATE_FORMATS } from '@/lib/utils'
```

Replace date formatting in:
- Message timestamps (around line 516)
- Notes display in thread
- Due date formatting

Use consistent patterns:
- Relative time for recent items: `formatDistanceWIB(date, { addSuffix: true })`
- Absolute time for older items: `formatWIB(date, DATE_FORMATS.DATETIME)`
</task>

<task id="4">
Update date grouping headers in message thread:

Change from:
```typescript
format(new Date(date), 'MMMM d, yyyy')
```

To:
```typescript
formatWIB(date, DATE_FORMATS.DATE_LONG)
```
</task>

## Verification

- [ ] All notes display timestamps in WIB timezone
- [ ] Activity timeline shows both relative and absolute times
- [ ] Due dates display with full date format
- [ ] Message date groupings use consistent WIB formatting
- [ ] No raw `format()` or `formatDistanceToNow()` calls remain without WIB conversion

## must_haves

- Notes display dates in WIB timezone
- Consistent date format across activity items
- Clear timestamp display (relative + absolute)
