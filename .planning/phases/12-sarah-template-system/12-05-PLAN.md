---
phase: 12-sarah-template-system
plan: 05
type: execute
wave: 1
depends_on: ["12-04"]
files_modified:
  - src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx
  - src/components/your-team/simplified-intern-settings.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Your Team page shows simplified Intern settings with just Bot Name, Persona, and Script fields"
    - "SarahConfigCard component is not rendered on the page"
    - "Complex InternSettings (4 collapsible cards) is replaced by simplified version"
  artifacts:
    - path: "src/components/your-team/simplified-intern-settings.tsx"
      provides: "Simplified 3-field Intern settings component"
      min_lines: 50
    - path: "src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx"
      provides: "Page using SimplifiedInternSettings"
      pattern: "SimplifiedInternSettings"
  key_links:
    - from: "src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx"
      to: "src/components/your-team/simplified-intern-settings.tsx"
      via: "import and render"
      pattern: "import.*SimplifiedInternSettings"
---

<objective>
Create simplified Intern settings with only 3 fields

Purpose: User feedback (Test 1) requests simplified UI: "just Bot Name, Persona, and a text box for the script they want or set, get rid of the other stuff"

Output: SimplifiedInternSettings component with 3 fields, integrated into Your Team page, replacing both SarahConfigCard and complex InternSettings.
</objective>

<execution_context>
@/home/jfransisco/.claude/get-shit-done/workflows/execute-plan.md
@/home/jfransisco/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/your-team/intern-settings.tsx
@src/components/team/sarah-config-card.tsx
@src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SimplifiedInternSettings component</name>
  <files>src/components/your-team/simplified-intern-settings.tsx</files>
  <action>
Create new component with exactly 3 fields per user request:

1. **Bot Name** (text input)
   - Simple text field for customizing the bot's display name
   - Default: "Sarah" or value from existing config
   - Links to settings page for full name change (like existing behavior)

2. **Persona** (dropdown select)
   - Options: "Professional", "Friendly", "Casual"
   - Maps to greeting style in existing config
   - Simple single-select dropdown

3. **Script** (textarea)
   - Large text area for custom system prompt
   - Maps to customPrompt in existing config
   - Placeholder: "Enter instructions for how your Intern should behave..."
   - Allow multiline input

Component structure:
```tsx
"use client"

import { useState, useEffect } from "react"
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card"
import { Input } from "@/components/ui/input"
import { Textarea } from "@/components/ui/textarea"
import { Label } from "@/components/ui/label"
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select"
import { Button } from "@/components/ui/button"
import { Bot, Save, ExternalLink } from "lucide-react"
import { toast } from "sonner"

interface SimplifiedInternSettingsProps {
  workspaceId: string
  workspaceSlug: string
}

export function SimplifiedInternSettings({ workspaceId, workspaceSlug }: SimplifiedInternSettingsProps) {
  // State for 3 fields
  const [botName, setBotName] = useState("Sarah")
  const [persona, setPersona] = useState("friendly")
  const [script, setScript] = useState("")
  const [loading, setLoading] = useState(true)
  const [saving, setSaving] = useState(false)
  const [isDirty, setIsDirty] = useState(false)

  // Load existing config on mount
  useEffect(() => {
    async function loadConfig() {
      try {
        // Load bot name
        const botRes = await fetch(`/api/workspaces/${workspaceId}/bot-config`)
        if (botRes.ok) {
          const data = await botRes.json()
          setBotName(data.intern_name || "Sarah")
        }

        // Load intern config (persona + script)
        const configRes = await fetch(`/api/workspaces/${workspaceSlug}/intern-config`)
        if (configRes.ok) {
          const config = await configRes.json()
          setPersona(config?.persona?.greetingStyle || "friendly")
          setScript(config?.persona?.customPrompt || "")
        }
      } catch (error) {
        console.error("Failed to load config:", error)
      } finally {
        setLoading(false)
      }
    }
    loadConfig()
  }, [workspaceId, workspaceSlug])

  // Save handler
  async function handleSave() {
    setSaving(true)
    try {
      // Save to intern-config endpoint
      const res = await fetch(`/api/workspaces/${workspaceSlug}/intern-config`, {
        method: "PATCH",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          persona: {
            greetingStyle: persona,
            customPrompt: script,
          }
        }),
      })

      if (!res.ok) throw new Error("Failed to save")

      toast.success("Intern settings saved")
      setIsDirty(false)
    } catch (error) {
      console.error("Failed to save:", error)
      toast.error("Failed to save settings")
    } finally {
      setSaving(false)
    }
  }

  if (loading) {
    return (
      <Card>
        <CardContent className="p-6">
          <div className="animate-pulse space-y-4">
            <div className="h-10 bg-muted rounded-md" />
            <div className="h-10 bg-muted rounded-md" />
            <div className="h-24 bg-muted rounded-md" />
          </div>
        </CardContent>
      </Card>
    )
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <Bot className="h-5 w-5" />
          Intern Settings
        </CardTitle>
        <CardDescription>
          Configure your AI assistant&apos;s personality and behavior
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-6">
        {/* Bot Name - display only, link to settings */}
        <div className="space-y-2">
          <Label>Bot Name</Label>
          <div className="flex items-center justify-between p-3 bg-muted/50 rounded-lg">
            <div className="flex items-center gap-3">
              <div className="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center">
                <Bot className="w-4 h-4 text-primary" />
              </div>
              <span className="font-medium">{botName}</span>
            </div>
            <Button variant="outline" size="sm" asChild>
              <a href={`/${workspaceSlug}/settings?section=bot-names`}>
                Change
                <ExternalLink className="w-3 h-3 ml-1" />
              </a>
            </Button>
          </div>
        </div>

        {/* Persona dropdown */}
        <div className="space-y-2">
          <Label htmlFor="persona">Persona</Label>
          <Select
            value={persona}
            onValueChange={(value) => {
              setPersona(value)
              setIsDirty(true)
            }}
          >
            <SelectTrigger id="persona">
              <SelectValue placeholder="Select persona" />
            </SelectTrigger>
            <SelectContent>
              <SelectItem value="professional">Professional - Formal and business-like</SelectItem>
              <SelectItem value="friendly">Friendly - Warm and approachable</SelectItem>
              <SelectItem value="casual">Casual - Relaxed and conversational</SelectItem>
            </SelectContent>
          </Select>
        </div>

        {/* Script textarea */}
        <div className="space-y-2">
          <Label htmlFor="script">Script</Label>
          <Textarea
            id="script"
            placeholder="Enter instructions for how your Intern should behave, what topics to cover, and how to respond to customers..."
            value={script}
            onChange={(e) => {
              setScript(e.target.value)
              setIsDirty(true)
            }}
            rows={6}
            className="resize-y"
          />
          <p className="text-xs text-muted-foreground">
            This script guides your Intern&apos;s responses and behavior
          </p>
        </div>

        {/* Save button */}
        <div className="flex justify-end pt-4 border-t">
          <Button
            onClick={handleSave}
            disabled={!isDirty || saving}
            className="gap-2"
          >
            <Save className="h-4 w-4" />
            {saving ? "Saving..." : "Save Changes"}
          </Button>
        </div>
      </CardContent>
    </Card>
  )
}
```

Dev mode handling: The component uses existing API endpoints which already handle dev mode. If needed, add explicit dev mode check for offline badge.
  </action>
  <verify>
1. File exists: `ls src/components/your-team/simplified-intern-settings.tsx`
2. File has required fields: `grep -E "(botName|persona|script)" src/components/your-team/simplified-intern-settings.tsx`
3. No lint errors: `npm run lint -- --quiet`
4. TypeScript compiles: `npm run type-check`
  </verify>
  <done>
- SimplifiedInternSettings component created
- Contains exactly 3 fields: Bot Name (display + link), Persona (dropdown), Script (textarea)
- Uses existing API endpoints for persistence
- Has loading state and save functionality
- No TypeScript or lint errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate SimplifiedInternSettings into Your Team page</name>
  <files>src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx</files>
  <action>
Update Your Team page to use SimplifiedInternSettings instead of SarahConfigCard and InternSettings:

1. Update imports:
   - Remove: `import { SarahConfigCard } from '@/components/team/sarah-config-card'`
   - Remove: `import { InternSettings } from '@/components/your-team/intern-settings'`
   - Add: `import { SimplifiedInternSettings } from '@/components/your-team/simplified-intern-settings'`

2. Replace content section:
   - Remove SarahConfigCard component usage
   - Remove InternSettings component usage with TabErrorBoundary
   - Add SimplifiedInternSettings with proper props

3. Final structure (after Plan 04 removes tabs):
```tsx
<div className="p-8 space-y-8">
  {/* Header */}
  <div>
    <h1 className="text-2xl font-bold text-foreground">Your Team</h1>
    <p className="text-sm text-muted-foreground mt-1">
      Manage your AI team members and their configurations
    </p>
  </div>

  {/* Intern Section Header */}
  <div>
    <h2 className="text-xl font-semibold text-foreground flex items-center gap-2">
      <Bot className="w-5 h-5" />
      Intern
    </h2>
    <p className="text-sm text-muted-foreground mt-1">
      Your AI assistant for lead qualification
    </p>
  </div>

  {/* Simplified Settings */}
  <TabErrorBoundary tabName="Intern Settings">
    <SimplifiedInternSettings
      workspaceId={workspace.id}
      workspaceSlug={workspace.slug}
    />
  </TabErrorBoundary>
</div>
```

4. Clean up unused imports:
   - Remove Tabs, TabsContent, TabsList, TabsTrigger if no longer used
   - Remove useState/useSearchParams/useRouter if no longer needed for tab navigation
  </action>
  <verify>
1. Run `npm run lint` - no errors
2. Run `npm run type-check` - no TypeScript errors
3. Grep confirms old components removed: `grep -n "SarahConfigCard\|InternSettings" src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx` - should return empty
4. Grep confirms new component present: `grep -n "SimplifiedInternSettings" src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx` - should find import and usage
  </verify>
  <done>
- SarahConfigCard removed from page
- Complex InternSettings removed from page
- SimplifiedInternSettings imported and rendered
- Page compiles without errors
- Unused imports cleaned up
  </done>
</task>

</tasks>

<verification>
1. `npm run lint` passes
2. `npm run type-check` passes
3. `npm run dev` starts without errors
4. SimplifiedInternSettings component exists with 3 fields
5. Your Team page renders SimplifiedInternSettings
6. Old complex components not imported in page
</verification>

<success_criteria>
- SimplifiedInternSettings component created with Bot Name (display), Persona (dropdown), Script (textarea)
- Your Team page uses SimplifiedInternSettings instead of SarahConfigCard + InternSettings
- No references to SarahConfigCard or InternSettings in the page file
- UI matches user request: simple 3-field form
- No TypeScript or lint errors
</success_criteria>

<output>
After completion, create `.planning/phases/12-sarah-template-system/12-05-SUMMARY.md`
</output>
