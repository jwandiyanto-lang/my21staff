---
phase: 04-settings
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/(dashboard)/[workspace]/settings/page.tsx
  - src/app/(dashboard)/[workspace]/settings/settings-client.tsx
autonomous: true

must_haves:
  truths:
    - "Settings page loads at /[workspace]/settings"
    - "User can view and edit integration settings"
    - "User can manage quick replies"
    - "User can manage contact tags"
    - "User can access data import/export"
    - "User can navigate to team management"
  artifacts:
    - path: "src/app/(dashboard)/[workspace]/settings/page.tsx"
      provides: "Server component that fetches workspace and renders SettingsClient"
      min_lines: 20
  key_links:
    - from: "src/app/(dashboard)/[workspace]/settings/page.tsx"
      to: "convex/workspaces.ts"
      via: "fetchQuery(api.workspaces.getBySlug)"
      pattern: "fetchQuery.*getBySlug"
    - from: "src/app/(dashboard)/[workspace]/settings/settings-client.tsx"
      to: "/api/workspaces/[id]/settings"
      via: "fetch PATCH request"
      pattern: "fetch.*api/workspaces"
---

<objective>
Create the settings page server component that renders the existing SettingsClient.

Purpose: Complete the settings page wiring so users can access workspace configuration. The SettingsClient component (865 lines) already exists with 4 tabs (Integrations, Quick Replies, Tags, Data). We just need the server component entry point.

Output: Working settings page at /[workspace]/settings with link to team management
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-settings/04-RESEARCH.md

# Existing patterns
@src/app/(dashboard)/[workspace]/database/page.tsx
@src/app/(dashboard)/[workspace]/settings/settings-client.tsx
@src/app/(dashboard)/[workspace]/team/page.tsx
@convex/workspaces.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create settings page.tsx server component</name>
  <files>src/app/(dashboard)/[workspace]/settings/page.tsx</files>
  <action>
Create a server component following the exact pattern from database/page.tsx:

1. Import dependencies:
   - notFound from 'next/navigation'
   - fetchQuery from 'convex/nextjs'
   - api from 'convex/_generated/api'
   - SettingsClient from './settings-client'
   - MOCK_WORKSPACE, isDevMode from '@/lib/mock-data'

2. Define props interface:
   ```typescript
   interface SettingsPageProps {
     params: Promise<{ workspace: string }>
   }
   ```

3. Implement async function:
   - Await params to get workspaceSlug (Next.js 15 async params pattern)
   - Handle dev mode with MOCK_WORKSPACE
   - Fetch workspace via fetchQuery(api.workspaces.getBySlug, { slug: workspaceSlug })
   - Return notFound() if workspace is null
   - Pass workspace props to SettingsClient matching its interface:
     - id: workspace._id
     - name: workspace.name
     - slug: workspace.slug
     - kapso_phone_id: workspace.kapso_phone_id || null
     - settings: workspace.settings || null

Important: SettingsClient expects kapso_phone_id and settings props (see settings-client.tsx interface).
  </action>
  <verify>
Run: `npm run build` - should compile without TypeScript errors
Run: `npm run dev` - navigate to /eagle-overseas/settings, page should load without errors
  </verify>
  <done>Settings page server component renders SettingsClient with correct workspace props</done>
</task>

<task type="auto">
  <name>Task 2: Add team management link to settings</name>
  <files>src/app/(dashboard)/[workspace]/settings/settings-client.tsx</files>
  <action>
Add a link/button in the settings header to navigate to team management:

1. Import Link from 'next/link'
2. Import Users icon from 'lucide-react'

3. In the header section (after the h1 and description), add a button that links to team page:
   ```tsx
   <Link href={`/${workspace.slug}/team`}>
     <Button variant="outline">
       <Users className="h-4 w-4 mr-2" />
       Kelola Tim
     </Button>
   </Link>
   ```

Place this in a flex container with justify-between to push it to the right of the header.

Note: UI text in Bahasa Indonesia per CLAUDE.md requirement (app UI language).
  </action>
  <verify>
Run: `npm run dev` - navigate to /eagle-overseas/settings
Check: "Kelola Tim" button visible in header
Click button - should navigate to /eagle-overseas/team
  </verify>
  <done>Settings page has visible link to team management page</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Settings page loads at /eagle-overseas/settings
3. Four tabs visible: Integrations, Quick Replies, Tags, Data
4. Kelola Tim button visible and links to /eagle-overseas/team
</verification>

<success_criteria>
- Settings page server component created with Convex fetchQuery pattern
- SettingsClient receives all required props (id, name, slug, kapso_phone_id, settings)
- Team management accessible via button in settings header
- No TypeScript errors in build
</success_criteria>

<output>
After completion, create `.planning/phases/04-settings/04-01-SUMMARY.md`
</output>
