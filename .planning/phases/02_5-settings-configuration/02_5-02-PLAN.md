---
wave: 1
depends_on: []
files_modified:
  - src/app/(dashboard)/[workspace]/settings/settings-client.tsx
  - convex/schema.ts
  - convex/botConfig.ts
  - src/app/api/workspaces/[workspace]/bot-config/route.ts
autonomous: true
---

# 02_5-02-PLAN.md: Bot Name Configuration in Settings

<objective>
Add bot name configuration to Settings page. This allows users to customize the names of their Intern (Sarah) and Brain (Grok) bots. Names are stored in Convex and used across the platform.
</objective>

<must_haves>
- New "Bot Names" card in Settings Integrations tab
- Configure Intern bot name (default: "Sarah")
- Configure Brain bot name (default: "Grok")
- Names stored in Convex botConfig table
- API endpoint for CRUD operations
- Changes take effect immediately (no page refresh needed)
- Dev mode works with mock data
</must_haves>

<tasks>

## Task 1: Add botConfig table to Convex schema

Create new Convex table for storing bot configuration per workspace.

Files modified:
- MODIFY: convex/schema.ts
  - Add botConfig table with fields:
    - workspace_id: v.id("workspaces")
    - intern_name: v.string() (default: "Sarah")
    - brain_name: v.string() (default: "Grok")
    - created_at: v.number()
    - updated_at: v.number()
  - Index by_workspace: ["workspace_id"]

Verification:
- [ ] Schema compiles without errors (npx convex dev)
- [ ] Table appears in Convex dashboard

## Task 2: Create botConfig Convex functions

Add Convex query and mutation for bot configuration.

Files modified:
- CREATE: convex/botConfig.ts
  - Query: getBotConfig(workspace_id) - returns config or default values
  - Mutation: updateBotConfig(workspace_id, intern_name, brain_name)
  - Include auth check for workspace membership

```typescript
// Default bot names
const DEFAULT_INTERN_NAME = "Sarah"
const DEFAULT_BRAIN_NAME = "Grok"

export const getBotConfig = query({
  args: { workspace_id: v.string() },
  handler: async (ctx, args) => {
    const config = await ctx.db
      .query("botConfig")
      .withIndex("by_workspace", q => q.eq("workspace_id", args.workspace_id))
      .first()

    return config || {
      intern_name: DEFAULT_INTERN_NAME,
      brain_name: DEFAULT_BRAIN_NAME,
    }
  },
})

export const updateBotConfig = mutation({
  args: {
    workspace_id: v.string(),
    intern_name: v.optional(v.string()),
    brain_name: v.optional(v.string()),
  },
  handler: async (ctx, args) => {
    // Upsert logic...
  },
})
```

Verification:
- [ ] Functions deploy without errors
- [ ] Query returns default values for new workspace
- [ ] Mutation creates/updates config

## Task 3: Create API route for bot config

Add Next.js API route that wraps Convex functions.

Files modified:
- CREATE: src/app/api/workspaces/[workspace]/bot-config/route.ts
  - GET: Return bot config for workspace
  - PATCH: Update bot config
  - Handle dev mode with mock data
  - Auth check via Clerk

```typescript
export async function GET(request: Request, { params }: { params: Promise<{ workspace: string }> }) {
  // Return bot config or defaults
}

export async function PATCH(request: Request, { params }: { params: Promise<{ workspace: string }> }) {
  // Update bot names
}
```

Verification:
- [ ] GET /api/workspaces/demo/bot-config returns default names
- [ ] PATCH updates and returns new config

## Task 4: Add Bot Names card to Settings page

Add UI card for configuring bot names in the Integrations tab.

Files modified:
- MODIFY: src/app/(dashboard)/[workspace]/settings/settings-client.tsx
  - Add "Bot Names" card after AI Assistant card in Integrations tab
  - Two input fields: Intern Name, Brain Name
  - Save button with loading state
  - Toast notification on success
  - Fetch initial values from API
  - Handle dev mode (update mock data)

UI Layout:
```
+------------------------------------------+
| Bot Names                                 |
| Configure your AI team member names       |
+------------------------------------------+
| Intern Name (Chat Bot)                    |
| [Sarah                               ]    |
| This name appears in conversations        |
|                                           |
| Brain Name (Manager Bot)                  |
| [Grok                                ]    |
| Used for summaries and analysis           |
|                                           |
|                        [Save Changes]     |
+------------------------------------------+
```

Verification:
- [ ] Bot Names card appears in Settings > Integrations
- [ ] Shows current bot names (default: Sarah, Grok)
- [ ] Can edit and save names
- [ ] Toast appears on save
- [ ] Works in dev mode

## Task 5: Add mock data support

Update mock data to include bot config.

Files modified:
- MODIFY: src/lib/mock-data.ts (if not already handling bot config)
  - Add MOCK_BOT_CONFIG with default names
  - Add getMockBotConfig() helper
  - Add updateMockBotConfig() helper

Verification:
- [ ] Dev mode returns mock bot config
- [ ] Changes persist in session (via window event or state)

</tasks>

<verification>
- [ ] botConfig table exists in Convex schema
- [ ] Convex functions compile and deploy
- [ ] API routes return correct data
- [ ] Settings page shows Bot Names card
- [ ] Can edit Intern and Brain names
- [ ] Save updates config in database
- [ ] Dev mode works offline
- [ ] No type errors (npm run type-check)
- [ ] No console errors in browser
</verification>
