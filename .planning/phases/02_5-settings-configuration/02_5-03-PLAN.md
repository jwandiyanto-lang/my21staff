---
wave: 2
depends_on: [02_5-01]
files_modified:
  - src/components/your-team/intern-settings.tsx
  - src/components/your-team/brain-settings.tsx
  - src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx
autonomous: true
---

# 02_5-03-PLAN.md: Bot Configuration Components (Intern & Brain)

<objective>
Build the bot configuration UI components for Intern (Sarah) and Brain (Grok) with settings boxes for persona, behavior rules, response settings, and bot-specific configurations.
</objective>

<must_haves>
- Intern Settings component with persona/prompt editor
- Intern Settings has behavior rules (when to respond, when to handoff)
- Intern Settings has response settings (length, emoji, price rules)
- Intern Settings has slot extraction config (name, service, budget, timeline)
- Brain Settings component with summary/scoring configuration
- Both use Shadcn/ui components (Card, Textarea, Input, Switch)
- Settings auto-save with toast notifications
- Dev mode works with mock data
</must_haves>

<tasks>

## Task 1: Create Intern Settings component

Build comprehensive settings component for the Intern (Sarah) chat bot.

Files modified:
- CREATE: src/components/your-team/intern-settings.tsx

Structure:
```tsx
interface InternSettingsProps {
  workspaceSlug: string
}

export function InternSettings({ workspaceSlug }: InternSettingsProps) {
  // Sections:
  // 1. Persona Card - Name, greeting style, tone
  // 2. Behavior Rules Card - When to respond, handoff triggers
  // 3. Response Settings Card - Max length, emoji usage, price rules
  // 4. Slot Extraction Card - Configure 4 slots (name, service, budget, timeline)
}
```

Card 1: Persona
- Bot Name display (from bot config - read only, link to Settings)
- Greeting Style dropdown (professional, friendly, casual)
- Language dropdown (Indonesian, English)
- Tone checkboxes (supportive, clear, encouraging)
- Custom prompt textarea

Card 2: Behavior Rules
- Auto-respond to new leads (switch)
- Handoff trigger keywords (tag input)
- Quiet hours toggle + time picker
- Max messages before human (number input)

Card 3: Response Settings
- Max message length (slider: 50-500 chars)
- Emoji usage (never, minimal, moderate)
- Price mentions (never, ranges only, exact)
- Response delay (instant, 2-5 sec, 5-10 sec)

Card 4: Slot Extraction
- Enable/disable slot extraction (switch)
- Slot list with checkboxes:
  - Name (required)
  - Service Interest
  - Budget Range
  - Timeline
- Custom slot input (add more)

Verification:
- [ ] Component renders without errors
- [ ] All cards display with correct fields
- [ ] Fields are editable
- [ ] Auto-save works with toast

## Task 2: Create Brain Settings component

Build settings component for the Brain (Grok) manager bot.

Files modified:
- CREATE: src/components/your-team/brain-settings.tsx

Structure:
```tsx
interface BrainSettingsProps {
  workspaceSlug: string
}

export function BrainSettings({ workspaceSlug }: BrainSettingsProps) {
  // Sections:
  // 1. Summary Settings Card
  // 2. Scoring Configuration Card
  // 3. Analysis Triggers Card
}
```

Card 1: Summary Settings
- Bot Name display (from bot config - read only)
- Daily summary enabled (switch)
- Summary time (time picker)
- Summary format (bullet points, paragraph, detailed)
- Include metrics (checkboxes: new leads, conversions, response times)

Card 2: Scoring Configuration
- Hot threshold (slider: 0-100, default 70)
- Warm threshold (slider: 0-100, default 40)
- Weight: Basic info (slider: 0-100)
- Weight: Qualification (slider: 0-100)
- Weight: Document (slider: 0-100)
- Weight: Engagement (slider: 0-100)
- Total must = 100 (validation)

Card 3: Analysis Triggers
- Trigger on handoff (switch)
- Trigger on keyword "!summary" (switch)
- Trigger on schedule (switch + cron input)
- Analysis depth (quick, standard, deep)

Verification:
- [ ] Component renders without errors
- [ ] All cards display with correct fields
- [ ] Scoring weights validate to 100
- [ ] Auto-save works with toast

## Task 3: Integrate settings into Your Team page

Update Your Team client to use new settings components.

Files modified:
- MODIFY: src/app/(dashboard)/[workspace]/your-team/your-team-client.tsx
  - In Intern tab, add InternSettings component below existing tabs
  - OR replace existing tabs with InternSettings sections
  - In Brain tab, render BrainSettings component

Decision: Keep existing Persona/Flow/Database/Slots tabs in Intern, but InternSettings provides a simplified "Quick Settings" view. For Phase 2.5, we can show the simplified settings boxes.

Updated structure:
```
Your Team
├── [Intern] [Brain]
│
└── Intern Tab:
    └── InternSettings component
        - Persona Card (with link to detailed Persona tab)
        - Behavior Rules Card
        - Response Settings Card
        - Slot Extraction Card (with link to detailed Slots tab)
│
└── Brain Tab:
    └── BrainSettings component
        - Summary Settings Card
        - Scoring Configuration Card
        - Analysis Triggers Card
```

Verification:
- [ ] Your Team page renders both tabs correctly
- [ ] Intern tab shows InternSettings
- [ ] Brain tab shows BrainSettings
- [ ] No layout issues or overflow

## Task 4: Add API endpoints for bot settings

Create API routes for saving/loading bot-specific settings.

Files modified:
- CREATE: src/app/api/workspaces/[workspace]/intern-config/route.ts
  - GET: Load intern settings
  - PATCH: Save intern settings

- CREATE: src/app/api/workspaces/[workspace]/brain-config/route.ts
  - GET: Load brain settings
  - PATCH: Save brain settings

Note: These can store in existing ariConfig or create new botInternConfig and botBrainConfig tables.

Verification:
- [ ] API routes work in dev mode (mock data)
- [ ] API routes work in production (Convex)

## Task 5: Add mock data for bot settings

Update mock data to support intern and brain configuration.

Files modified:
- MODIFY: src/lib/mock-data.ts
  - Add MOCK_INTERN_CONFIG with default values
  - Add MOCK_BRAIN_CONFIG with default values
  - Add getMockInternConfig(), updateMockInternConfig()
  - Add getMockBrainConfig(), updateMockBrainConfig()

Verification:
- [ ] Dev mode loads mock settings
- [ ] Changes persist during session

</tasks>

<verification>
- [ ] InternSettings component renders all 4 cards
- [ ] BrainSettings component renders all 3 cards
- [ ] Your Team page shows settings in Intern tab
- [ ] Your Team page shows settings in Brain tab
- [ ] Auto-save works with toast notifications
- [ ] Scoring weights validate to 100 total
- [ ] Dev mode works offline with mock data
- [ ] No type errors (npm run type-check)
- [ ] No console errors in browser
</verification>
