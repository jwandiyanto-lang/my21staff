---
phase: 02-your-intern-debug
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/error-boundaries/tab-error-boundary.tsx
  - src/app/(dashboard)/[workspace]/knowledge-base/knowledge-base-client.tsx
autonomous: true

must_haves:
  truths:
    - "Individual tab errors do not crash entire page"
    - "Failed tab shows error UI with retry button"
    - "Other tabs remain functional when one fails"
  artifacts:
    - path: "src/components/error-boundaries/tab-error-boundary.tsx"
      provides: "Reusable error boundary for tabs"
      exports: ["TabErrorBoundary"]
    - path: "src/app/(dashboard)/[workspace]/knowledge-base/knowledge-base-client.tsx"
      provides: "Client with error boundaries around tabs"
      contains: "TabErrorBoundary"
  key_links:
    - from: "src/app/(dashboard)/[workspace]/knowledge-base/knowledge-base-client.tsx"
      to: "src/components/error-boundaries/tab-error-boundary.tsx"
      via: "wraps each TabsContent"
      pattern: "<TabErrorBoundary"
---

<objective>
Add error boundaries around individual tabs to prevent cascading failures.

Purpose: When one tab component fails (e.g., API error, render error), it should show an error UI with retry option rather than crashing the entire Your Intern page. This makes the page resilient to partial failures.

Output: Error boundaries wrap each tab, failed tabs show error state while others remain functional.
</objective>

<execution_context>
@/home/jfransisco/.claude/get-shit-done/workflows/execute-plan.md
@/home/jfransisco/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@planning/PROJECT.md
@planning/ROADMAP.md
@planning/phases/02-your-intern-debug/02-01-SUMMARY.md

@planning/phases/02-your-intern-debug/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-error-boundary</name>
  <files>package.json</files>
  <action>
Install react-error-boundary package:
```bash
npm install react-error-boundary
```

This library provides a hooks-based error boundary API that's cleaner than class-based boundaries.
  </action>
  <verify>Package is in package.json dependencies: `grep "react-error-boundary" package.json`</verify>
  <done>react-error-boundary is installed</done>
</task>

<task type="auto">
  <name>Task 2: Create TabErrorBoundary component</name>
  <files>src/components/error-boundaries/tab-error-boundary.tsx</files>
  <action>
Create error boundary component following the pattern from 02-RESEARCH.md:

```typescript
'use client'

import { ErrorBoundary } from 'react-error-boundary'
import { AlertCircle } from 'lucide-react'
import { Button } from '@/components/ui/button'

interface TabErrorBoundaryProps {
  children: React.ReactNode
  tabName: string
}

function TabErrorFallback({
  error,
  resetErrorBoundary
}: {
  error: Error
  resetErrorBoundary: () => void
}) {
  return (
    <div className="flex flex-col items-center justify-center py-12 px-4 text-center">
      <AlertCircle className="w-12 h-12 text-destructive mb-4" />
      <h3 className="text-lg font-semibold mb-2">Failed to Load Tab</h3>
      <p className="text-sm text-muted-foreground mb-4 max-w-md">
        {error.message || 'An unexpected error occurred'}
      </p>
      <Button onClick={resetErrorBoundary} variant="outline">
        Try Again
      </Button>
    </div>
  )
}

export function TabErrorBoundary({ children, tabName }: TabErrorBoundaryProps) {
  return (
    <ErrorBoundary
      FallbackComponent={TabErrorFallback}
      onError={(error, info) => {
        console.error(`[${tabName} Tab Error]`, error)
        console.error('Component stack:', info.componentStack)
      }}
      onReset={() => {
        console.log(`Resetting ${tabName} tab`)
      }}
    >
      {children}
    </ErrorBoundary>
  )
}
```

Create the error-boundaries directory if it doesn't exist.
  </action>
  <verify>File exists and exports TabErrorBoundary: `grep -l "export function TabErrorBoundary" src/components/error-boundaries/tab-error-boundary.tsx`</verify>
  <done>TabErrorBoundary component created with fallback UI and logging</done>
</task>

<task type="auto">
  <name>Task 3: Wrap tabs with error boundaries</name>
  <files>src/app/(dashboard)/[workspace]/knowledge-base/knowledge-base-client.tsx</files>
  <action>
Update KnowledgeBaseClient to wrap each TabsContent with TabErrorBoundary:

1. Add import at top:
```typescript
import { TabErrorBoundary } from '@/components/error-boundaries/tab-error-boundary'
```

2. Wrap each TabsContent children:

```typescript
<TabsContent value="persona" className="space-y-6">
  <TabErrorBoundary tabName="Persona">
    <PersonaTab workspaceId={workspace.id} />
  </TabErrorBoundary>
</TabsContent>

<TabsContent value="flow" className="space-y-6">
  <TabErrorBoundary tabName="Flow">
    <FlowTab workspaceId={workspace.id} />
  </TabErrorBoundary>
</TabsContent>

<TabsContent value="database" className="space-y-6">
  <TabErrorBoundary tabName="Database">
    <DatabaseTab workspaceId={workspace.id} />
  </TabErrorBoundary>
</TabsContent>

<TabsContent value="scoring" className="space-y-6">
  <TabErrorBoundary tabName="Scoring">
    <ScoringTab workspaceId={workspace.id} />
  </TabErrorBoundary>
</TabsContent>

<TabsContent value="slots" className="space-y-6">
  <TabErrorBoundary tabName="Slots">
    <SlotManager workspaceId={workspace.id} teamMembers={teamMembers} />
  </TabErrorBoundary>
</TabsContent>
```

This ensures each tab can fail independently without affecting others.
  </action>
  <verify>
Count TabErrorBoundary usage: `grep -c "TabErrorBoundary" src/app/(dashboard)/[workspace]/knowledge-base/knowledge-base-client.tsx`
Should return 6 (1 import + 5 usages)
  </verify>
  <done>All 5 tabs wrapped with TabErrorBoundary, errors isolated per tab</done>
</task>

</tasks>

<verification>
After all tasks:
1. `npm run dev` starts without errors
2. Navigate to http://localhost:3000/demo/knowledge-base
3. All tabs still load correctly
4. To test error boundary:
   - Temporarily add `throw new Error('Test')` at start of PersonaTab component
   - Persona tab should show error fallback UI
   - Other tabs (Flow, Database, etc.) should still work
   - Remove test error after verification
</verification>

<success_criteria>
- react-error-boundary installed
- TabErrorBoundary component exists
- All 5 tabs wrapped with error boundaries
- Tab errors show fallback UI, not blank page
- Other tabs remain functional when one fails
</success_criteria>

<output>
After completion, create `.planning/phases/02-your-intern-debug/02-02-SUMMARY.md`
</output>
