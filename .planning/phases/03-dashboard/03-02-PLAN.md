---
phase: 03-dashboard
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/app/(dashboard)/[workspace]/page.tsx
  - src/app/(dashboard)/[workspace]/dashboard-client.tsx
  - src/components/dashboard/stats-cards.tsx
  - src/components/dashboard/quick-actions.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard page loads at /[workspace]/"
    - "Stats cards show contact and conversation counts"
    - "Time filter toggles between week/month/all"
    - "Quick actions navigate to inbox, database, and add contact"
  artifacts:
    - path: "src/app/(dashboard)/[workspace]/page.tsx"
      provides: "Dashboard route with workspace validation"
      min_lines: 15
    - path: "src/app/(dashboard)/[workspace]/dashboard-client.tsx"
      provides: "Client component with useQuery hooks"
      min_lines: 30
    - path: "src/components/dashboard/stats-cards.tsx"
      provides: "Stats grid with time filter"
      min_lines: 50
    - path: "src/components/dashboard/quick-actions.tsx"
      provides: "Navigation shortcuts"
      min_lines: 25
  key_links:
    - from: "src/app/(dashboard)/[workspace]/dashboard-client.tsx"
      to: "api.dashboard.getStats"
      via: "useQuery hook"
      pattern: "useQuery.*dashboard\\.getStats"
---

<objective>
Create the dashboard page structure with stats cards and quick actions.

Purpose: Main workspace landing page showing CRM overview. Users see contact/conversation counts with time filtering and quick navigation shortcuts.

Output: Dashboard page at /[workspace]/ with real-time stats and quick actions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-dashboard/03-CONTEXT.md
@.planning/phases/03-dashboard/03-RESEARCH.md
@src/app/(dashboard)/[workspace]/inbox/page.tsx
@src/app/(dashboard)/[workspace]/inbox/inbox-client.tsx
@src/app/(dashboard)/[workspace]/database/page.tsx
@src/components/skeletons/dashboard-skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dashboard page and client component</name>
  <files>
src/app/(dashboard)/[workspace]/page.tsx
src/app/(dashboard)/[workspace]/dashboard-client.tsx
  </files>
  <action>
Create dashboard page following inbox pattern:

**page.tsx (server component):**
```typescript
import { notFound } from 'next/navigation'
import { fetchQuery } from 'convex/nextjs'
import { api } from 'convex/_generated/api'
import { DashboardClient } from './dashboard-client'
import { MOCK_WORKSPACE, isDevMode } from '@/lib/mock-data'

interface DashboardPageProps {
  params: Promise<{ workspace: string }>
}

export default async function DashboardPage({ params }: DashboardPageProps) {
  const { workspace: workspaceSlug } = await params

  // Dev mode: use mock workspace
  if (isDevMode()) {
    return <DashboardClient workspaceId={MOCK_WORKSPACE.id as any} workspaceSlug={MOCK_WORKSPACE.slug} />
  }

  // Production: validate workspace exists via Convex
  const workspace = await fetchQuery(api.workspaces.getBySlug, {
    slug: workspaceSlug,
  })

  if (!workspace) {
    notFound()
  }

  return <DashboardClient workspaceId={workspace._id} workspaceSlug={workspace.slug} />
}
```

**dashboard-client.tsx (client component):**
- 'use client' directive
- Import useState from react
- Import useQuery from convex/react
- Import api from convex/_generated/api
- Import DashboardSkeleton
- Import StatsCards and QuickActions components
- Import type Id from convex/_generated/dataModel

Props: workspaceId: Id<'workspaces'>, workspaceSlug: string

State:
- timeFilter: 'week' | 'month' | 'all' (default 'all')

Query:
- const stats = useQuery(api.dashboard.getStats, { workspace_id: workspaceId as any, time_filter: timeFilter })

Render:
- If stats === undefined, return DashboardSkeleton
- Return layout with:
  - Header: "Dashboard" title
  - StatsCards with stats, timeFilter, onTimeFilterChange
  - QuickActions with workspaceSlug
  - Placeholder div for activity feed (to be added in Plan 03)
  </action>
  <verify>
Run `npm run dev` and navigate to /[workspace]/. Page should load without errors. DashboardSkeleton should show while loading.
  </verify>
  <done>
Dashboard page loads at workspace root. Stats query executes on mount.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create StatsCards component with time filter</name>
  <files>src/components/dashboard/stats-cards.tsx</files>
  <action>
Create stats-cards.tsx following RESEARCH.md pattern:

'use client' directive

Imports:
- Card, CardContent, CardHeader, CardTitle from @/components/ui/card
- Tabs, TabsList, TabsTrigger from @/components/ui/tabs
- Users, MessageSquare, UserCheck, UserX from lucide-react

Interface StatsCardsProps:
- stats: { totalContacts, totalConversations, activeConversations, statusBreakdown }
- timeFilter: 'week' | 'month' | 'all'
- onTimeFilterChange: (filter: 'week' | 'month' | 'all') => void

Component structure:
1. Header row with "Statistik" title and Tabs for time filter
2. TabsList with 3 triggers: "7 Hari" (week), "30 Hari" (month), "Semua" (all)
3. Grid of stat cards (md:grid-cols-2 lg:grid-cols-4):
   - Total Kontak (Users icon)
   - Percakapan (MessageSquare icon)
   - Hot Leads (UserCheck icon, green) - stats.statusBreakdown.hot || 0
   - Cold Leads (UserX icon, muted) - stats.statusBreakdown.cold || 0

StatCard helper:
- Card with CardHeader (title + icon) and CardContent (value formatted with toLocaleString('id-ID'))
- Match existing dashboard-skeleton.tsx spacing

Use Indonesian labels per CLAUDE.md language requirement.
  </action>
  <verify>
Stats cards render with correct data. Time filter tabs work. Numbers display with Indonesian locale.
  </verify>
  <done>
StatsCards shows workspace metrics with working time filter toggle.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create QuickActions component</name>
  <files>src/components/dashboard/quick-actions.tsx</files>
  <action>
Create quick-actions.tsx:

'use client' directive

Imports:
- Card, CardContent, CardHeader, CardTitle from @/components/ui/card
- Button from @/components/ui/button
- Link from next/link
- Plus, MessageSquare, Users from lucide-react

Interface QuickActionsProps:
- workspaceSlug: string

Component structure:
1. Card with "Aksi Cepat" title
2. CardContent with flex row of action buttons:
   - "Tambah Kontak" (Plus icon) -> /${workspaceSlug}/database?action=add (or modal trigger)
   - "Inbox" (MessageSquare icon) -> /${workspaceSlug}/inbox
   - "Database" (Users icon) -> /${workspaceSlug}/database

Buttons as Link components with Button styling:
- variant="outline"
- size="sm"
- Icon on left, text label

Per CONTEXT.md: Fixed set for v3.2, customization deferred.
  </action>
  <verify>
Quick action buttons render. Links navigate correctly.
  </verify>
  <done>
QuickActions provides navigation shortcuts to main CRM features.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` starts without errors
2. Navigate to /eagle-overseas/ (or workspace slug)
3. Dashboard shows stats cards with time filter
4. Quick actions navigate to correct pages
5. Loading state shows DashboardSkeleton
</verification>

<success_criteria>
- Dashboard page loads at /[workspace]/ route
- Stats cards display real data from Convex
- Time filter changes query results
- Quick actions provide navigation
- UI uses Indonesian labels
</success_criteria>

<output>
After completion, create `.planning/phases/03-dashboard/03-02-SUMMARY.md`
</output>
