---
phase: 06-dashboard
plan: 06
type: execute
wave: 3
depends_on: ["06-01", "06-02", "06-03", "06-04", "06-05"]
files_modified:
  - src/lib/mock-data.ts
  - src/components/sidebar.tsx
  - src/app/(dashboard)/[workspace]/layout.tsx
autonomous: true

must_haves:
  truths:
    - "All dashboard pages work in offline dev mode"
    - "Sidebar navigation includes Leads and Insights links"
    - "Loading states show skeletons, not blank screens"
    - "Error states display user-friendly messages"
    - "Inbox conversations load and display correctly"
    - "Inbox messaging functionality works"
  artifacts:
    - path: "src/lib/mock-data.ts"
      provides: "Complete mock data for all dashboard features"
      contains: ["MOCK_LEADS", "MOCK_SUMMARY", "MOCK_ACTIONS", "MOCK_INSIGHTS"]
  key_links:
    - from: "sidebar navigation"
      to: "/[workspace]/leads"
      via: "Link component"
      pattern: "href.*leads"
    - from: "sidebar navigation"
      to: "/[workspace]/insights"
      via: "Link component"
      pattern: "href.*insights"

# Note: INBX-01 to INBX-05 implemented in Phase 2.5, verified in Task 3
prior_phase_verification:
  - phase: "2.5"
    requirements: ["INBX-01", "INBX-02", "INBX-03", "INBX-04", "INBX-05"]
    verification: "Task 3 includes inbox functional verification"
---

<objective>
Polish dashboard with complete mock data, navigation updates, and error handling for production readiness.

Purpose: Ensure all Phase 6 features work seamlessly in both dev mode and production.
Output: Fully functional dashboard with sidebar navigation, dev mode support, and graceful error handling.
</objective>

<execution_context>
@/home/jfransisco/.claude/get-shit-done/workflows/execute-plan.md
@/home/jfransisco/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-dashboard/06-CONTEXT.md

# Existing mock data patterns
@src/lib/mock-data.ts

# Summary of prior plans
@.planning/phases/06-dashboard/06-01-SUMMARY.md
@.planning/phases/06-dashboard/06-02-SUMMARY.md
@.planning/phases/06-dashboard/06-03-SUMMARY.md
@.planning/phases/06-dashboard/06-04-SUMMARY.md
@.planning/phases/06-dashboard/06-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Consolidate and Expand Mock Data</name>
  <files>
    src/lib/mock-data.ts
  </files>
  <action>
    Consolidate all mock data into a single source of truth:

    1. **Add MOCK_LEADS** (if not already complete):
       - 15-20 sample leads with variety of stages and scores
       - Include Indonesian names and phone numbers
       - Include notes arrays with bot and human entries
       - Include pain points and business types

       ```tsx
       export const MOCK_LEADS = [
         {
           _id: 'lead-001',
           phone: '+62 812-3456-7890',
           name: 'Budi Santoso',
           leadStatus: 'qualified',
           leadScore: 78,
           leadTemperature: 'hot' as const,
           businessType: 'Restaurant',
           painPoints: ['Scheduling staff', 'Inventory management'],
           lastActivityAt: Date.now() - 2 * 60 * 60 * 1000,
           created_at: Date.now() - 7 * 24 * 60 * 60 * 1000,
           notes: [
             { content: 'Interested in staff scheduling feature', addedBy: 'sarah-bot', addedAt: Date.now() - 3600000 },
             { content: 'Budget confirmed: 500k/month', addedBy: 'grok-bot', addedAt: Date.now() - 7200000 },
           ],
         },
         // ... 14 more leads with varying data
       ]
       ```

    2. **Add MOCK_BRAIN_SUMMARY**:
       ```tsx
       export const MOCK_BRAIN_SUMMARY = {
         _id: 'summary-001',
         summary_text: "Hari ini bagus! 5 lead baru masuk, 2 diantaranya menunjukkan sinyal hot. Budi Santoso dan Dewi Lestari keduanya menyebutkan kebutuhan mendesak soal timeline. Prioritaskan follow-up call hari ini. Response rate 85% - pertahankan momentum!",
         summary_type: 'daily',
         trigger: 'cron',
         created_at: Date.now() - 8 * 60 * 60 * 1000,
         metrics: {
           newLeadsCount: 5,
           hotLeadsCount: 2,
           warmLeadsCount: 8,
           coldLeadsCount: 12,
           avgScore: 45,
         },
       }
       ```

    3. **Add MOCK_BRAIN_ACTIONS**:
       ```tsx
       export const MOCK_BRAIN_ACTIONS = [
         {
           _id: 'action-001',
           workspace_id: 'demo',
           contact_id: 'lead-001',
           action_type: 'follow_up',
           priority: 92,
           urgency: 'immediate' as const,
           reason: 'Hot lead dengan budget terkonfirmasi, belum di-follow up 3 hari',
           suggested_message: 'Halo Pak Budi! Terima kasih sudah berbagi detail bisnis Anda. Kapan waktu yang nyaman untuk ngobrol lebih lanjut tentang kebutuhan scheduling tim?',
           status: 'pending',
           created_at: Date.now() - 2 * 60 * 60 * 1000,
         },
         // ... more actions
       ]
       ```

    4. **Add MOCK_BRAIN_INSIGHTS**:
       ```tsx
       export const MOCK_BRAIN_INSIGHTS = [
         {
           _id: 'insight-001',
           workspace_id: 'demo',
           insight_type: 'trending_topic',
           pattern: 'Employee scheduling',
           frequency: 8,
           confidence: 'high' as const,
           examples: ['Susah atur jadwal karyawan', 'Shift management ribet'],
           suggested_faqs: [{
             question: 'Bagaimana cara atur jadwal shift?',
             suggested_answer: 'Dengan my21staff, Anda bisa atur jadwal shift dengan drag-and-drop interface yang mudah digunakan.',
           }],
           time_range: 'week',
           created_at: Date.now() - 24 * 60 * 60 * 1000,
         },
         // ... more insights
       ]
       ```

    5. **Add MOCK_LEAD_STATS**:
       ```tsx
       export const MOCK_LEAD_STATS = {
         total: 127,
         byStatus: { new: 45, qualified: 32, contacted: 28, converted: 15, archived: 7 },
         byTemperature: { hot: 8, warm: 24, lukewarm: 35, cold: 60 },
         newToday: 5,
         newThisWeek: 23,
         newThisMonth: 78,
         avgScore: 42,
       }
       ```

    6. **Export all mock data with clear naming**:
       - Use MOCK_ prefix consistently
       - Add JSDoc comments explaining each mock
       - Ensure types match actual Convex schemas
  </action>
  <verify>
    All mock data exports added to mock-data.ts
    npm run type-check passes
    Mock data types match Convex schemas
  </verify>
  <done>
    Complete mock data for all dashboard features consolidated in mock-data.ts
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Sidebar Navigation</name>
  <files>
    src/components/sidebar.tsx
  </files>
  <action>
    Update sidebar to include new dashboard pages:

    1. **Find sidebar component**:
       - Look for src/components/sidebar.tsx or similar
       - May be in a layout component

    2. **Add navigation items**:
       - **Dashboard** (existing or add) - /[workspace]/dashboard or /[workspace]
       - **Leads** (new) - /[workspace]/leads with Users icon
       - **Inbox** (existing) - /[workspace]/inbox
       - **Insights** (new) - /[workspace]/insights with Sparkles icon
       - **Your Team** (existing) - /[workspace]/your-team
       - **Settings** (existing) - /[workspace]/settings

       ```tsx
       import { Users, MessageSquare, Sparkles, Settings, LayoutDashboard, Bot } from 'lucide-react'

       const navItems = [
         { href: `/${workspace}/dashboard`, label: 'Dashboard', icon: LayoutDashboard },
         { href: `/${workspace}/leads`, label: 'Leads', icon: Users },
         { href: `/${workspace}/inbox`, label: 'Inbox', icon: MessageSquare },
         { href: `/${workspace}/insights`, label: 'Insights', icon: Sparkles },
         { href: `/${workspace}/your-team`, label: 'Your Team', icon: Bot },
         { href: `/${workspace}/settings`, label: 'Settings', icon: Settings },
       ]
       ```

    3. **Update active state styling**:
       - Ensure current route is highlighted
       - Use pathname matching for active detection

    4. **Verify navigation order**:
       - Dashboard first (home)
       - Leads second (primary feature)
       - Inbox third (messaging)
       - Insights fourth (analytics)
       - Your Team and Settings last (configuration)

    **Note**: If sidebar is in a different location or uses a different pattern, adapt accordingly. The key is adding Leads and Insights navigation items.
  </action>
  <verify>
    Sidebar shows Leads and Insights navigation items
    Clicking Leads navigates to /[workspace]/leads
    Clicking Insights navigates to /[workspace]/insights
    Active state highlights correctly for each route
  </verify>
  <done>
    Sidebar navigation updated with Leads and Insights links
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify Dev Mode, Error Boundaries, and Inbox Functionality</name>
  <files>
    src/app/(dashboard)/[workspace]/leads/leads-client.tsx
    src/app/(dashboard)/[workspace]/insights/insights-client.tsx
    src/app/(dashboard)/[workspace]/dashboard/dashboard-client.tsx
  </files>
  <action>
    Ensure all dashboard pages work correctly in dev mode and handle errors:

    1. **Verify dev mode check pattern**:
       Each client component should have:
       ```tsx
       const isDevMode = process.env.NEXT_PUBLIC_DEV_MODE === 'true'
       ```

    2. **Verify Convex query skip pattern**:
       ```tsx
       const data = useQuery(api.something, isDevMode ? 'skip' : { args })
       ```

    3. **Verify mock data fallback**:
       ```tsx
       const finalData = isDevMode ? MOCK_DATA : (data ?? [])
       ```

    4. **Add error boundary or error handling**:
       - Wrap client components in try-catch where appropriate
       - Add fallback UI for error states
       - Log errors for debugging

       ```tsx
       // Simple error handling pattern
       if (error) {
         return (
           <Card className="border-red-200 bg-red-50">
             <CardContent className="py-6 text-center">
               <p className="text-red-600">Unable to load data. Please try again later.</p>
               <Button variant="outline" onClick={() => window.location.reload()}>
                 Refresh
               </Button>
             </CardContent>
           </Card>
         )
       }
       ```

    5. **Test all dashboard routes in dev mode**:
       Navigate to each route and verify no errors:
       - http://localhost:3000/demo/dashboard
       - http://localhost:3000/demo/leads
       - http://localhost:3000/demo/insights

    6. **Verify loading skeletons**:
       - Each page should show skeleton during load
       - No blank screens or layout shifts
       - Skeletons match approximate content size

    7. **Verify Inbox completion from Phase 2.5 (INBX-01 to INBX-05)**:
       - Navigate to http://localhost:3000/demo/inbox
       - **INBX-01**: Verify conversation list loads and displays
       - **INBX-02**: Verify messages display in conversation view
       - **INBX-03**: Verify message input field works (type and send)
       - **INBX-04**: Verify real-time updates work (or mock data in dev mode)
       - **INBX-05**: Verify conversation selection switches message view
       - Confirm no console errors on inbox page

    8. **Check console for errors**:
       - No React warnings
       - No Convex errors in dev mode
       - No hydration mismatches
  </action>
  <verify>
    All three dashboard pages load without errors in dev mode
    Inbox page loads and displays conversations/messages correctly
    npm run dev runs without errors
    No console errors or warnings
    Loading skeletons display during initial load
    All mock data renders correctly
    Navigation between pages works smoothly
  </verify>
  <done>
    All dashboard pages verified working in dev mode with proper error handling.
    Inbox functionality from Phase 2.5 (INBX-01 to INBX-05) confirmed functional.
  </done>
</task>

</tasks>

<verification>
- All dashboard features work in offline dev mode (localhost:3000/demo/*)
- Sidebar shows Leads and Insights navigation items
- Navigation between dashboard pages is smooth
- Loading states show skeletons
- No console errors or warnings
- Mock data renders correctly on all pages
- Inbox conversations load, messages display, and send functionality works (INBX-01-05)
</verification>

<success_criteria>
1. Complete mock data for leads, summaries, actions, insights, stats
2. Sidebar navigation includes Leads and Insights
3. All pages work offline in dev mode
4. Loading states use skeleton components
5. No TypeScript or ESLint errors
6. Inbox from Phase 2.5 verified functional (INBX-01 to INBX-05)
</success_criteria>

<output>
After completion, create `.planning/phases/06-dashboard/06-06-SUMMARY.md`
</output>
