# Requirements Archive: v2.2 ARI & User Flow

**Archived:** 2026-01-20
**Status:** SHIPPED

This is the archived requirements specification for v2.2.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## v2.2 Requirements

Requirements for ARI & User Flow milestone. Converts social media leads into paid consultations.

### ARI Core Conversation

- [x] **ARI-01**: ARI pulls form data from CRM when user initiates WhatsApp conversation
- [x] **ARI-02**: ARI greets user by name with context from their form submission
- [x] **ARI-03**: ARI validates form completeness and asks follow-up questions
- [x] **ARI-04**: ARI answers questions about universities/destinations
- [x] **ARI-05**: ARI asks document readiness questions
- [x] **ARI-06**: ARI maintains conversation context across message turns
- [x] **ARI-07**: ARI uses natural Indonesian language with configurable persona

### Lead Scoring

- [x] **SCORE-01**: Dynamic lead scoring (0-100) based on form + conversation
- [x] **SCORE-02**: Basic data scoring: form completeness, valid phone/email
- [x] **SCORE-03**: Qualification scoring: IELTS, GPA, budget, timeline
- [x] **SCORE-04**: Engagement scoring: response time, question quality
- [x] **SCORE-05**: Score thresholds: Hot (70+), Warm (40-69), Cold (<40)
- [x] **SCORE-06**: Lead phase auto-update in CRM based on score

### Lead Routing

- [x] **ROUTE-01**: Hot leads (70+) receive consultation booking push
- [x] **ROUTE-02**: Warm leads (40-69) continue qualification conversation
- [x] **ROUTE-03**: Cold leads (<40) receive WhatsApp community link
- [x] **ROUTE-04**: Cold lead follow-up scheduled (30 days)

### Payment Integration (Deferred → v2.3)

- [ ] **PAY-01**: Midtrans payment gateway integration
- [ ] **PAY-02**: Payment link generation (Rp500,000)
- [ ] **PAY-03**: Indonesian payment methods (QRIS, GoPay, OVO)
- [ ] **PAY-04**: Payment success callback
- [ ] **PAY-05**: Payment failure/expiry handling
- [ ] **PAY-06**: Payment link validity (24 hours)

### Scheduling

- [x] **SCHED-01**: Admin enters consultant availability slots
- [x] **SCHED-02**: ARI displays available slots after scoring
- [x] **SCHED-03**: User selects slot via WhatsApp
- [x] **SCHED-04**: Appointment confirmation message
- [x] **SCHED-05**: Meeting link notification 1 hour before
- [x] **SCHED-06**: Appointment status tracking

### Consultant Handoff

- [x] **HAND-01**: Lead status updates to "hot_lead" after booking
- [x] **HAND-02**: Auto-generated notes with conversation summary
- [x] **HAND-03**: Due date set to consultation date
- [x] **HAND-04**: Consultant assignment to appointment
- [x] **HAND-05**: Consultant notification with full lead context

### Admin Interface - Persona

- [x] **ADMIN-01**: Editable bot name
- [x] **ADMIN-02**: Greeting style configuration
- [x] **ADMIN-03**: Language setting
- [x] **ADMIN-04**: Tone configuration
- [x] **ADMIN-05**: Community link setting

### Admin Interface - Knowledge Base

- [x] **KB-01**: University/destination CRUD
- [x] **KB-02**: Country > City > University hierarchy
- [x] **KB-03**: Requirements per university
- [x] **KB-04**: Programs list per university
- [x] **KB-05**: Promotion toggle and priority
- [x] **KB-06**: Notes field for special info

### Admin Interface - Scoring

- [x] **ADMIN-06**: Scoring threshold configuration
- [x] **ADMIN-07**: Scoring weight adjustments

### Admin Interface - AI Models (Deferred → v2.3)

- [ ] **AI-01**: AI model selection (Grok, Sea-Lion)
- [ ] **AI-02**: A/B testing toggle
- [ ] **AI-03**: Model comparison dashboard
- [ ] **AI-04**: Default model selection

### Inbox Improvements

- [x] **INBOX-01**: Kapso metadata caching
- [x] **INBOX-02**: Cache refresh via webhook
- [x] **INBOX-03**: Real-time message updates
- [x] **INBOX-04**: Active/All filter toggle
- [x] **INBOX-05**: Filter by tags
- [x] **INBOX-06**: Filter by lead status
- [x] **INBOX-07**: Improved Kapso sync

### Database Schema

- [x] **DB-01**: ari_config table
- [x] **DB-02**: ari_destinations table
- [x] **DB-03**: ari_conversations table
- [x] **DB-04**: ari_messages table
- [x] **DB-05**: ari_payments table
- [x] **DB-06**: ari_appointments table
- [x] **DB-07**: ari_ai_comparison table
- [x] **DB-08**: Cached fields on contacts
- [x] **DB-09**: RLS policies for all tables

---

## Milestone Summary

**Shipped:** 46 of 56 requirements
**Deferred:** 10 requirements (PAY-01 to PAY-06, AI-01 to AI-04)

**Requirements Adjusted:**
- SCHED-02: "after payment" changed to "after scoring" (payment deferred)

**Requirements Dropped:**
- None

---
*Archived: 2026-01-20 as part of v2.2 milestone completion*
